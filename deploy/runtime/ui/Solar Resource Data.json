{
    "Name": "Solar Resource Data",
    "Width": 894.0,
    "Height": 972.0,
    "FormObjects": {
        "GroupBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "GroupBox2"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 9.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 12.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 870.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 363.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Solar Resource Library"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Hyperlink": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "Hyperlink2"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 504.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 853.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "For locations not covered by the NSRDB, visit the SAM website Weather Page for links to other data sources."
                },
                "URL": {
                    "Type": 5.0,
                    "String": "https://sam.nrel.gov/weather-data"
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 0.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "annual_albedo"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 666.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 864.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "annual_beam"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 198.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 849.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 2.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "annual_diffuse"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 198.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 876.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 2.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "annual_global"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 198.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 822.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 2.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "annual_snow"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 666.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 837.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "annual_tdry"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 198.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 903.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "annual_wspd"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 198.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 930.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Button": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "btn_add_file_to_library"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 714.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 567.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 153.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 30.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Add file to library"
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 11.0
                }
            }
        },
        "Button": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "btn_add_remove_folders"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 621.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 306.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 252.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 30.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Add/remove weather file folders..."
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 2.0
                }
            }
        },
        "Button": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "btn_download"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 651.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 474.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 223.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Download and add to library..."
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 10.0
                }
            }
        },
        "Button": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "btn_refresh_library"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 621.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 336.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 252.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 30.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Refresh library"
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 3.0
                }
            }
        },
        "Button": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "btn_view_data"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 715.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 609.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 153.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 30.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "View data..."
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 12.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "caption_library"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 63.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 855.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 36.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "SAM's default library comes with only a few weather files to help you get started. Use the download tools below to build a library of locations you frequently model. Once you build your library, it is available for all of your work in SAM."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": -1.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "caption_techs"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 555.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 663.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 307.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 63.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": ""
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "download_weather_caption"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 393.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 855.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 51.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "The NSRDB is a database of thousands of weather files that you can download and add to your to your solar resource library: Download a default typical-year (TMY) file for most long-term cash flow analyses, or choose files to download for single-year or P50/P90 analyses. See Help for details."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": -1.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "elev"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 108.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 750.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 317.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 9.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "folder_caption"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 264.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 855.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 39.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "SAM scans the following folders on your computer for valid weather files and adds them to your Solar Resource library. To use weather files stored on your computer, click Add/remove Weather File Folders and add folders containing valid weather files."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": -1.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Divider": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "group_optional"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 465.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 816.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 363.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 19.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Orientation": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Colour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 120.0,
                        "Green": 120.0,
                        "Blue": 120.0,
                        "Alpha": 255.0
                    }
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Optional Data"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "TextEntry": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "in_location"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 474.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 366.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Text": {
                    "Type": 5.0,
                    "String": ""
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 6.0
                }
            }
        },
        "StringArray": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "in_location_list"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 282.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 474.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 99.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Label": {
                    "Type": 5.0,
                    "String": "List of locations"
                },
                "Description": {
                    "Type": 5.0,
                    "String": "Type or import a list of addresses or lat,lon in decimal degrees"
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 7.0
                }
            }
        },
        "RadioChoice": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "in_location_options"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 447.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 261.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Selection": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Items": {
                    "Type": 6.0,
                    "StringList": "One location|Multiple locations"
                },
                "ShowCaptions": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Horizontal": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 4.0
                }
            }
        },
        "Choice": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "in_nsrdb_options"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 390.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 474.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 258.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Items": {
                    "Type": 6.0,
                    "StringList": "Default TMY file|Choose year|Download files for all years (P50/P90)"
                },
                "Selection": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 7.0
                }
            }
        },
        "RadioChoice": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "in_time_step"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 405.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 447.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 222.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Selection": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Items": {
                    "Type": 6.0,
                    "StringList": "60-minute|30-minute"
                },
                "ShowCaptions": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Horizontal": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 8.0
                }
            }
        },
        "CheckBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "is_advanced"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 660.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 447.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 215.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Advanced download"
                },
                "State": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 9.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "lat"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 108.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 669.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 1.1
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 10.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "library_caption6"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 30.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 855.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 33.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "The Solar Resource library is a list of weather files on your computer. Choose a file from the library and verify the weather data information below."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": -1.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "MultilineText": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "library_folder_list"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 306.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 588.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 60.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Text": {
                    "Type": 5.0,
                    "String": "List of Solar Resource library folders"
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "lon"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 108.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 696.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 1.2
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 11.0
                }
            }
        },
        "Divider": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "object 22"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 801.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 849.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 16.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Orientation": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Colour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 120.0,
                        "Green": 120.0,
                        "Blue": 120.0,
                        "Alpha": 255.0
                    }
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Annual Averages Calculated from Weather File  Data"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Divider": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "object 2236"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 30.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 642.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 840.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 16.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Orientation": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Colour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 120.0,
                        "Green": 120.0,
                        "Blue": 120.0,
                        "Alpha": 255.0
                    }
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Header Data from Weather File"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "GroupBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "object 4"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 9.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 375.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 870.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 162.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Download Weather Files"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "GroupBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "object 423"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 9.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 537.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 870.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 432.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Weather Data Information"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "object 7"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 291.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 732.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 570.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 60.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "For NSRDB data, the latitude and longitude shown here from the weather file header are the coordinates of the NSRDB grid cell and may be different from the values in the file name, which are the coordinates of the requested location."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "object 735"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 393.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 930.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 222.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "*NaN indicates missing data."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 0.0
                }
            }
        },
        "TextEntry": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "solar_data_file_name"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 318.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 609.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 390.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Text": {
                    "Type": 5.0,
                    "String": ""
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "TextEntry": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "solar_data_file_name_load"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 318.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 609.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 390.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Text": {
                    "Type": 5.0,
                    "String": ""
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "TextEntry": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "solar_data_source"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 369.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 696.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 183.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Text": {
                    "Type": 5.0,
                    "String": "src"
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 7.0
                }
            }
        },
        "Library": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "solar_resource"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 105.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 855.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 159.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Library": {
                    "Type": 5.0,
                    "String": "SolarResourceData"
                },
                "Fields": {
                    "Type": 5.0,
                    "String": "Name,Latitude,Longitude,Time zone,Elevation,Station ID,Source,Version"
                }
            }
        },
        "TextEntry": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "solar_resource_file"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 102.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 609.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 604.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Text": {
                    "Type": 5.0,
                    "String": ""
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 29.0,
                        "Green": 80.0,
                        "Blue": 173.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 222.0,
                        "Green": 233.0,
                        "Blue": 244.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "TextEntry": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "station_id"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 369.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 669.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 183.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Text": {
                    "Type": 5.0,
                    "String": "wban"
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 7.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "summary_caption"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 564.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 690.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 36.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": ""
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "tz"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 108.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 723.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": -7.5
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": "GMT "
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 8.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ui_step_minutes"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 108.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 777.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "use_specific_weather_file"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 618.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 609.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 90.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "TextEntry": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "user_specified_weather_file"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 318.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 609.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 390.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Text": {
                    "Type": 5.0,
                    "String": ""
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        }
    },
    "VarDatabase": {
        "annual_albedo": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Annual albedo",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "annual_beam": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Direct normal (beam)",
            "Units": "kWh/m²/day",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 4.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "annual_diffuse": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Diffuse horizontal",
            "Units": "kWh/m²/day",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 4.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "annual_global": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Global horizontal",
            "Units": "kWh/m²/day",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 20.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "annual_snow": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Maximum snow depth",
            "Units": "cm",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "annual_tdry": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Average temperature",
            "Units": "°C",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 4.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "annual_wspd": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Average wind speed",
            "Units": "m/s",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 4.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "city": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "City",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": "<invalid>",
            "UIObject": "TextEntry",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "country": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Country",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": "<invalid>",
            "UIObject": "TextEntry",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "elev": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Elevation",
            "Units": "m",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "file_name": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Weather file name required by some SSC modules",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 9.0,
            "DefaultValue": "",
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "in_location": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Location input (address or lat/lon)",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 1.0,
            "DefaultValue": "Type a street address or latitude, longitude (skip for advanced)",
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "in_location_list": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "List of locations",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "abc",
            "Flags": 0.0,
            "DefaultValue": "15458 Denver W Pkwy, Golden CO 804041|phoenix,az|45.5,-120.9|Manaus,Brazil",
            "UIObject": "StringArray",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "in_location_options": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Location options (0=one,1=multiple)",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 1.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "in_nsrdb_options": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "NSRDB options",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 1.0,
            "DefaultValue": 0.0,
            "UIObject": "Choice",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "in_time_step": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Time Step option (0=60 min,1=30 min)",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 1.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "is_advanced": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Legacy and 30-minute data (advanced)",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 1.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "lat": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Latitude",
            "Units": "degrees",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "library_folder_list": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Solar resource library folders",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 5.0,
            "DefaultValue": "",
            "UIObject": "MultilineText",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "library_paths": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Solar resource library file path list",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": "",
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "lon": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Longitude",
            "Units": "degrees",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "solar_data_file_name": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Weather file name from solar resource library",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 4.0,
            "DefaultValue": "",
            "UIObject": "TextEntry",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "solar_data_file_name_load": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Weather file when user interface loaded",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 4.0,
            "DefaultValue": "",
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "solar_data_source": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Data Source",
            "Units": " ",
            "Group": " Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": "src",
            "UIObject": "TextEntry",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "solar_resource": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Solar resource library current selection",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "SolarResourceData|0",
            "Flags": 19.0,
            "DefaultValue": "",
            "UIObject": "Library",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "solar_resource_file": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Weather file",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 0.0,
            "DefaultValue": "",
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "state": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "State",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": "<invalid>",
            "UIObject": "TextEntry",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "station_id": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Location",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": "",
            "UIObject": "TextEntry",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "step": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Time step",
            "Units": "seconds",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 4.0,
            "DefaultValue": 3600.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "tz": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Time zone",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ui_step_minutes": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Time step",
            "Units": "minutes",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "use_specific_weather_file": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Use weather file from script (legacy)",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 6.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "user_specified_weather_file": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Weather file specified from script 0 or 1 (legacy)",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 6.0,
            "DefaultValue": "",
            "UIObject": "TextEntry",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "wf_nrecords": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Number of weather file records",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 4.0,
            "DefaultValue": 8760.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        }
    },
    "Equations": "equations{'solar_resource_file'} = define() {\n\tif ( ${use_specific_weather_file} ) \n\t\t{ return ${user_specified_weather_file}; }\n\telse \n\t\t{ return ${solar_data_file_name}; }// file name from solar resource library csv file\n};\n\nequations{'file_name'} = define() {\n\t// for compatibility with most SSC APIs\n\treturn ${solar_resource_file};\n};\n\nequations{'ui_step_minutes'} = define() {\n\treturn(${step}/60);\n};\n",
    "Callbacks": "on_load{'Solar Resource Data'} = define() {\n\t//msgbox('on load');\n\t//hide legacy data for 2020.2.29 Patch 3\n\tshow('is_advanced',true);\n\ton_change{'in_location_options'}();\n\ton_change{'in_nsrdb_options'}();\n\ton_change{'is_advanced'}();\n\t// store value of current library item in case an LK script changes the selected library item\n\tvalue('solar_data_file_name_load', value('solar_data_file_name'));\n\t// UI updates do not work consistently if these variables do not have widgets. They are stacked under the solar_resource_file widget.\n\tshow('use_specific_weather_file', false); // determines whether user_specified_weather_file is used instead of solar_data_file_name\n\tshow('user_specified_weather_file', false); // requires use_specific_weather_file = 1, set by LK script\n\tshow('solar_data_file_name_load', false); // stores weather file name when UI form loaded\n\tshow('solar_data_file_name', false); // value from SolarResourceData CSV file\n\tshow('in_time_step', value('in_nsrdb_options') != 0 ); \n\trefresh();\n\tupdate_library_folders(''); // refresh list of library folders\n\tupdate_info( 'on_load Solar Resource Data');\n};\n\n// library list, this gets triggered before on_load\non_change{'solar_resource'} = define() {\n\t// in case LK script changes library selection without setting use_specifc_weather_file to zero\n\t//msgbox('on_change solar_resource');\n\tif ( value('solar_data_file_name_load' ) != value('solar_data_file_name') )\n\t{\n\t\tvalue('use_specific_weather_file',0); \n\t}\n\tupdate_info('on_change solar_resource');\n};\n\non_change{'use_specific_weather_file'} = define() {\n\tif ( value('use_specific_weather_file') == 1 )\n\t{\n\t\tupdate_info('on_change use_specific_weather_file');\n\t}\n};\n\non_change{ 'btn_add_file_to_library' } = define () {\n\tf_name = value( 'solar_resource_file' );\n\tf_name = slash_back_to_forward( f_name );\n\tupdate_library_folders( path_only( f_name ) );\n\tvalue( 'solar_resource', file_to_key( f_name ) );\n};\n\non_change{ 'in_location_options' } = define() {\n\tshow('in_location_list',  value('in_location_options') == 1 && !value('is_advanced') );\n\tshow('in_location',       value('in_location_options') == 0 && !value('is_advanced') );\n\trefresh('');\n};\n\non_change{ 'in_nsrdb_options' } = define() {\n\tshow('in_location_list',   value('in_location_options') == 1 && !value('is_advanced') );\n\tshow('in_location',        value('in_location_options') == 0 && !value('is_advanced') );\n\tshow('in_location_options', !value('is_advanced') );\n\t// 30-minute data not available for tmy\n\tshow('in_time_step', value('in_nsrdb_options') != 0 ); \n\trefresh('');\n};\n\non_change{ 'is_advanced' } = define() {\n\tif ( value('is_advanced') ) {\n\t\tproperty( 'download_weather_caption' , 'Caption' , 'Click the Download button to choose files from a complete list of files available from the NSRDB, including TMY, TGY, TDY for different years and subhourly data.');\n\t\tproperty( 'download_weather_caption' , 'TextColour', 'black' );\n\t}\n\telse {\n\t\tproperty( 'download_weather_caption' , 'Caption' , 'The NSRDB is a database of thousands of weather files that you can download and add to your to your solar resource library: Download a default typical-year (TMY) file for most long-term cash flow analyses, or choose files to download for single-year or P50/P90 analyses. See Help for details.' );\n\t\tproperty( 'download_weather_caption' , 'TextColour', 'black' );\n\t}\n\tshow('in_location_list', ( value('in_location_options') && !value('is_advanced') ) );\n\tshow('in_location', ( !value('in_location_options') && !value('is_advanced') ) );\n\tshow('in_location_options', !value('is_advanced') );\n\tshow('in_nsrdb_options', !value('is_advanced') );\n\tshow('in_time_step', !value('is_advanced') && value('in_nsrdb_options') != 0 );\n\trefresh('');\n};\n\non_change{'btn_refresh_library'} = define() {\n\tupdate_library_folders('');\n\tupdate_info('on_change btn_refesh_library');\n};\n\n// add/remove weather file folders\non_change{'btn_add_remove_folders'} = define() {\n\tif ( showsettings( 'solar' ) )\n\t{\n\t\tupdate_library_folders( '' );\n\t}\n};\n\non_change{'btn_view_data'} = define() {\n\tif ( dview_solar(value('solar_resource_file')) )\n\t{\tmsgbox('Failed to read file!\\nThe data viewer was not able to open the weather file:\\n' + value('solar_resource_file') ); }\n};\n\non_change{'btn_download'} = define() {\n\tif ( value( 'is_advanced' ) ) { nsrdb_all(); }\n\telse { nsrdb_get(); }\n\trescanlibrary( 'solar' );\n\tupdate_library_folders( '' );\n\trefresh('solar_resource');\n};\n\n/////////////////////////////////////////////\n// Functions\n/////////////////////////////////////////////\n\n// attempt to determine if location string is valid lat/lon pair\n// given a location string loc_in, return:\n//  * loc_in if appears to be a location name or address\n//  * comma separated lat/lon pair in Decimal Degrees if valid comma or space separated lat/lon pair \n//  * null if not a valid lat/lon pair\n// also return msg string description if invalid\nfunction test_decimal_degrees( loc_in ) \n{\n\tarr = split( loc_in, ' ' ); \n\tis_space_delimited_pair = false;\n\tis_space_delimited_address = false;\n\tloc_out = null;\n\tmsg = '';\n\tif ( #arr == 2 && strpos(loc_in,',') < 0 ) // test for space-separated lat/lon, city/state, or city/country pair\n\t{\n\t\tmsg = '\\\"' + loc_in + '\\\"' + ' not recognized. Please use a comma to separate latitude and longitude values in Decimal Degrees, or to separate city and state/province or country names.';\n\t\tis_space_delimited_pair = true;\n\t}\n\telseif ( #arr > 2 ) // test for street address with one comma\n\t{\n\t\tis_space_delimited_address = true;\n\t}\n\tstr = replace( loc_in, ', ', ',' ); // allow comma followed by space\n\tarr = [];\n\tarr = split( str, ',' );\n\tif ( #arr == 2 && !is_space_delimited_pair && !is_space_delimited_address) // loc_in may be a lat/lon pair\n\t{\n\t\tlat = lower(arr[0]); \n\t\tlon = lower(arr[1]);\n\n\t\tis_nsew = false;\n\t\tif ( (to_real(lat) !=0)  && (to_real(lon) != 0) ) // test for N, S, E, or W in string (not valid for decimal degrees)\n\t\t{\n\t\t\tis_nsew = ( ( strpos(lat,'n') > -1 || strpos(lat,'s') > -1 ) && ( strpos(lon,'w') > -1 || strpos(lon,'e') > -1 ) );\n\t\t}\n\t\tis_valid_range =  ( ( to_real(lat) >= -90 && to_real(lat) <= 90 ) || ( to_real(lon) >=-180 && to_real(lon) <= 180 ) );\n\t\tis_string = ( to_real(lat) == 0 && to_real(lon) == 0 ); // assumes no one is modeling a system at 0,0\n\t\tmsg = '';\n\t\tif ( is_nsew )\n\t\t{\n\t\t\tmsg = '\\\"' + loc_in + '\\\"' + ' is not a valid lat/lon pair in Decimal Degrees (uses N/S, E/W). Please convert to Decimal Degrees.';\n\t\t}\n\t\telseif ( is_string )\n\t\t{\n\t\t\tloc_out = loc_in;\n\t\t\tmsg = '\\\"' + loc_in + '\\\"' + ' appears to be a city/state pair.';\n\t\t}\n\t\telseif ( is_valid_range )\n\t\t{\n\t\t\tloc_out = lat + ',' + lon;\n\t\t\tmsg = '\\\"' + loc_in + '\\\"' + ' appears to be a valid lat/lon pair in Decimal Degrees.';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmsg = '\\\"' + loc_in + '\\\"' + ' not recognized. Please enter a valid street address, location name, or latitude/longitude pair in Decimal Degrees (lat,lon).';\n\t\t}\n\t}\n\telseif ( !is_space_delimited_pair ) // loc_in likely a location name\n\t{\n\t\tloc_out = loc_in;\n\t\tmsg = '\\\"' + loc_in + '\\\"' + ' appears to be a street address or location name.';\n\t}\n\treturn [loc_out, msg ]; \n}\n\nfunction file_to_key( file ) \n{\n\t\tkey = file_only( file );\n\t\tkey = replace( key, '.' + ext_only( file ), '' );\n\t\treturn key;\n}\n\nfunction slash_back_to_forward( str )\n{\n\treturn replace( str, '\\\\', '/' );\n}\n\n// given a key or file item from the library, return if exists t/f, key, file, and key for first item\n// is_key = true if library key with no path or extension\n// is_key = false if file name with full path and extension\n// should also work with no parameters to return number of files in library and in deploy/solar_resource folder\nfunction solar_library( item, is_key )\n{\n\tT = {};\n\tlib_file = userlocaldatadir() + '/SolarResourceData.csv';\n\tlib_data = csvread( lib_file, { 'table' = true } );\n\tfiles = lib_data{'File name'}; files -@ 0; files -@ 0;\n\tfor( i=0; i<#files; i++) { files[i] = lower(slash_back_to_forward(files[i])); }\n\tkeys = lib_data{'Name'}; keys -@ 0; keys -@ 0;\n\tif ( is_key ) { ii = keys ?@ item; }\n\telse { ii = files ?@ lower(item); }\n\tT{'is_in_library'} = false; \n\tT{'lib_key'} = null;\n\tif ( ii > -1 ) \n\t{\n\t\tT{'is_in_library'} = true; \n\t\tT{'lib_key'} = keys[ii];\n\t\tT{'file_name'} = files[ii];\n\t}\n\tT{'num_files_in_library'} = #files;\n\tstr = slash_back_to_forward( appdir() );\n\tarr = split( str, '/' );\n\tarr -@ #arr-1;\n\tarr[#arr] = 'solar_resource';\n\tdefault_path = '';\n\tfor( i=0; i<#arr; i++ ) {default_path += arr[i] + '/'; }\n\tdefault_files = dir_list( default_path, '*', false );\n\tT{'num_default_files'} = #default_files;\n\treturn T;\n}\n\n// update weather file, annual summaries and summary text based on whether file is from library or user specified via LK script\n// ctxt is for testing to see when function was called\nfunction update_info( ctxt )\n{\n\twf = value('solar_resource_file'); \n\tL = strlen( value( 'library_folder_list' ) );\n\t/*msgbox('Hello from update_info() in ' + ctxt + '!\\nsolar_resource_file = ' + value('solar_resource_file')\n\t       + '\\nsolar_data_file_name = ' + value('solar_data_file_name')\n\t       + '\\n\\nsolar_data_file_name_load = ' + value('solar_data_file_name_load')  \n\t       + '\\n\\nuser_specified_weather_file = ' + value('user_specified_weather_file')\n\t       + '\\n\\nfile_name = ' + value('file_name') \n\t       + '\\n\\nsolar_resource = ' + value('solar_resource') \n\t       + '\\n\\nwf is in library = ' + solar_library(value('solar_resource_file'),false){'is_in_library'}\n\t       + '\\n\\ncurrent selection is in library = ' + solar_library(value('solar_resource'),true){'is_in_library'} );*/\n\t\n\t//if selected library file is no longer in library reload library, and exit\n\twf_ok = false;\n\tif (!file_exists(wf) )\n\t{\n\t\tmsg_caption = 'Weather file does not exist. Please choose or download a different file above.';\n\t\tmsg_color = 'red';\n\t\tshow_button = false;\n\t\trescanlibrary('solar'); // remove deleted file from library\n\t}\n\t// display message depending on whether file is in library or is a user-specified file\n\telseif ( wf != value('solar_data_file_name') )\n\t{\n\t\tmsg_caption = 'The weather file is different from the file selected in the library because it was modified by an LK script. Click Add File to Library if you want the file to appear in the library list above.';\n\t\tmsg_color = 'red';\n\t\tshow_button = true;\n\t}\n\telseif ( strlen( value( 'library_folder_list' ) ) < L ) // ** this check should never be true, right???\n\t{\n\t\tmsg_caption = 'Weather file folder not in list? Please choose or download a different file above, or click Add file to library.';\n\t\tmsg_color = 'red';\n\t\tshow_button = true;\n\t}\n\telseif ( !solar_library(slash_back_to_forward(value('solar_resource')),true){'is_in_library'} )\n\t{\n\t\tmsg_caption = 'Weather file is not in library. Please choose or download a different file above, or click Add file to library.';\n\t\tmsg_color = 'red';\n\t\tshow_button = true;\n\t}\n\telse\n\t{\n\t\tmsg_caption = 'The following information describes the data in the highlighted weather file from the Solar Resource library above. This is the file SAM will use when you click Simulate.';\n\t\tmsg_color = 'black';\n\t\tshow_button = false;\n\t\twf_ok = true;\n\t}\n\n\t// show / hide PV only summary data\n\tis_pv = ( technology() == 'Flat Plate PV' || technology() == 'PVWatts' );\n\tproperty( 'summary_caption' , 'Caption' , msg_caption );\n\tproperty( 'summary_caption' , 'TextColour' , msg_color );\n\tshow('btn_add_file_to_library', show_button);\n\tshow('group_optional', is_pv );\n\tshow('annual_snow', is_pv );\n\tshow('annual_albedo',is_pv );\n\trefresh(''); // always refresh after calling show()\n\n\t// display message for new users if library contains only default files\n\tproperty( 'caption_library', 'Caption', 'The default library comes with only a few weather files to help you get started. Use the download tools below to build a library of locations you frequently model. Once you build your library, it is available for all of your work in SAM.' );\n\tproperty( 'caption_library', 'TextColour', 'black' );\n\tlib = solar_library( 'dummy', false );\n\tif ( lib{'num_files_in_library'} == lib{'num_default_files'} )\n\t{\n\t\tproperty( 'caption_library', 'Caption', 'You have not added any weather files to your library. To add files, use the download tools below to get weather files from the NSRDB, or click Add Remove Weather File folders to add files from your computer. The default library comes with only a few weather files to help you get started.' );\n\t\tproperty( 'caption_library', 'TextColour', 'red' );\n\t}\n\n\t// calculate and display annual summary data\n\tif ( wf_ok )\n\t{\n\t\tobj = ssc_create();\n\t\tssc_var( obj, 'file_name', wf );\n\t\tresult = ssc_exec( obj, 'wfreader' );\n\t\tif ( 0 == result )\n\t\t{\n\t\t\tvalue( 'annual_global', ssc_var(obj, 'annual_glob') );\n\t\t\tvalue( 'annual_beam', ssc_var(obj, 'annual_beam') );\n\t\t\tvalue( 'annual_diffuse', ssc_var(obj, 'annual_diff') );\n\t\t\tvalue( 'annual_tdry', ssc_var(obj, 'annual_tdry') );\n\t\t\tvalue( 'annual_wspd', ssc_var(obj, 'annual_wspd') );\n\t\t\tvalue( 'annual_snow', ssc_var(obj, 'annual_snow') );\n\t\t\tvalue( 'annual_albedo', ssc_var(obj, 'annual_albedo') );\n\t\t\tvalue( 'step', ssc_var(obj, 'step') );\n\t\t\trhum = ssc_var(obj, 'rhum');\n\t\t\trhum_ok = true;\n\t\t\tif ( isnan( rhum[0] ) ) { rhum_ok = false; }\n\t\t\t// used for timestep calculation in editscene3d\n\t\t\tvalue( 'wf_nrecords', ssc_var(obj, 'nrecords') );\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmsgbox('Weather file reader failed!\\n' \n\t\t\t+ result\n\t\t\t+ '\\n\\nTo avoid this message, remove  the following file from your weather file folders: \\n' + wf);\n\t\t\tvalue( 'annual_global', nan() );\n\t\t\tvalue( 'annual_beam', nan() );\n\t\t\tvalue( 'annual_diffuse', nan() );\n\t\t\tvalue( 'annual_tdry', nan() );\n\t\t\tvalue( 'annual_wspd', nan() );\n\t\t\tvalue( 'annual_snow', nan() );\n\t\t\tvalue( 'annual_albedo', nan() );\n\t\t\tvalue( 'wf_nrecords', nan() );\n\t\t}\n\t\tssc_free( obj );\n\t}\n\t\n\tif ( librarygetcurrentselection('solar_resource') == '' )\n\t{\n\t\tlibrarynotifytext('solar_resource','Please choose a file. Nothing selected.');\n\t}\n\telseif ( !solar_library(slash_back_to_forward(value('solar_resource')),true){'is_in_library'} ) \n\t{\n\t\tlibrarynotifytext('solar_resource', 'Please choose a file. Current selection not in library.');\n\t}\n\telseif (librarygetnumbermatches('solar_resource') < 1)\n\t{\n\t\tvalue('in_location', librarygetfiltertext('solar_resource'));\n\t\tlibrarynotifytext('solar_resource', 'No match found. Try downloading a weather file below.');\n\t}\n\telseif ( librarygetcurrentselection('solar_resource') != file_to_key( value('solar_resource_file')) )\n\t{\n\t\tlibrarynotifytext('solar_resource','Current selection is different from weather file.');\n\t}\n\telse\n\t{\n\t\tlibrarynotifytext('solar_resource', ''); //'Everything is fine.'\n\t\tvalue('in_location', 'Type a location name, street address, or lat,lon in decimal degrees');\n\t}\n\t\n\t//msgbox('libraryget functions'+\n\t//'\\nfiltertext = ' + librarygetfiltertext('solar_resource') \n\t//+ '\\nnumber matches = ' + librarygetnumbermatches('solar_resource') \n\t//+ '\\ncurrentselection = ' + librarygetcurrentselection('solar_resource'));\n\t\n\tdisplay_tech_message();\n}\n\n// update ui list of library folders, and optionally add new path to library folders\nfunction update_library_folders( new_path )\n{\n\t//msgbox('Hello from update_library_folders()');\n\tx = get_settings('solar_data_paths');\n\t// add new path if provided and it doesn't already exist in the library\n\tif ( new_path != '' && dir_exists( new_path ) && ( strpos( x, new_path ) < 0 ) )\n\t{\n\t\tif ( x != '' ) { x += ';'; }\n\t\tx += slash_back_to_forward( new_path );\n\t}\n\t// list of library folders files to display on separate lines\n\tpaths = split( x, ';' );\n\t// put solar download folder at top of list\n\tclean_list = '';\n\t// remove folders in list that no longer exist\n\tfor (i = 0; i<#paths; i++ )\n\t{\n\t\tif ( dir_exists( paths[i] ) )\n\t\t{\n\t\t\tclean_list += paths[i];\n\t\t\tif ( i < #paths-1 ) { clean_list += ';'; }\n\t\t}\t\n\t}\t\t\n\t// update solar_data_paths used by library.cpp and nsrdb.cpp to cleaned list\t\t\n\tset_settings('solar_data_paths', clean_list );\n\t// update list to display\n\tvalue( 'library_folder_list', get_settings('solar_download_path') + '\\n' \n\t       + replace( clean_list , ';' , '\\n' ) );\n\trescanlibrary( 'solar' );        \n}\n\nfunction display_tech_message() \n{\n\tstr = '';\n\tstr_and = '';\n\ttech = technology();\n\tcsp_techs = ['Physical Trough','Empirical Trough','MSPT','DSPT','MSLF','DSLF','Dish Stirling','Generic CSP System'];\n\tfor ( i=0; i<#csp_techs; i++ )\n\t{\n\t\tif ( tech == csp_techs[i] ) \n\t\t{\n\t\t\tstr = 'CSP models use a different time convention than NREL NSRDB data. See Help for details.';\n\t\t}\t\n\t}\n\tif ( tech == 'Biopower' )\n\t{ \n\t\tif ( isnan( value('annual_global') ) || !rhum_ok )\n\t\t{\n\t\t\tstr = 'The Biopower model requires ';\n\t\t}\n\t\tif ( isnan( value('annual_global' ) ) ) \n\t\t{\n\t\t\tstr += 'global horizontal irradiance data ';\n\t\t\tstr_and = 'and ';\n\t\t}\t\n\t\tif ( !rhum_ok ) \n\t\t{\n\t\tstr += str_and + 'relative humidity data. See Help for details.';\n\t\t}\t\n\t}\n\tproperty( 'caption_techs' , 'Caption', str );\t\t\n\tproperty( 'caption_techs' , 'TextColour', 'red' );\n}\n\n// display window for advanced download\nfunction nsrdb_all() \n{\n\thash = nsrdbquery();\n\t// meta data\n\tif ( hash != '' )\n\t{ \n\t\tfn = hash{'file'};\n\t\tdn = hash{'folder'};\n\t\taf = hash{'addfolder'};\n\t\tif ( fn != '' )\n\t\t{\n\t\t\terror = wf_check( fn );\n\t\t}\t\n\t\tif (af == \"no\")\n\t\t{\n\t\t\tif ((fn != '') && (dn != ''))\n\t\t\t{\n\t\t\t\tvalue( 'use_specific_weather_file', 1 );\n\t\t\t\tfn = replace(fn, '\\\\', '/');\n\t\t\t\tvalue( 'user_specified_weather_file', fn );\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\trescanlibrary( 'solar' );  //** is this necessary??\n\t\t\tif (fn != '')\n\t\t\t{\n\t\t\t\tvalue( 'use_specific_weather_file', 0 );\n\t\t\t\tvalue( 'solar_resource', file_to_key( fn ) );\n\t\t\t}\n\t\t}\n\t}\n}\n\n// clean up location string to use as file name\nfunction clean_name( location )\n{\n\tname = location;\n\tname = replace( name , ', ' , ',' );\n\tname = replace( name , ',' , '_' );\n\tname = replace( name , '  ' , ' ' );\n\tname = replace( name , ' ' , '_' );\n\treturn lower(name);\n}\n\n// return a set of urls for valid datasets available for a location\nfunction nsrdb( location, is_tmy )\n{\n\tname = '';\n\turl = '';\n\tyears = [];\n\tmsg = '';\n\tg = {'lat'=null,'lon'=null, tz=null, 'ok'=false};\n\tgeocode_ok = false;\n\tjson_ok = false;\n\tlocation_ok = false;\n\tis_suny = false;\n\tif ( strpos(lower(location),'type a location name') > -1 )\n\t{\n\t\tmsg += 'Invalid location name: \\n\\n' + location + '\\n\\n';\n\t}\n\telse\n\t{\n\t\tloc_test = test_decimal_degrees( location );\n\t\tmsg += loc_test[1] + '\\n\\n';\n\t\tif (  loc_test[0] != null )\n\t\t{\n\t\t\tlocation_ok = true;\n\t\t\tlocation = loc_test[0];\n\t\t\tg = geocode( location );\n\t\t\t// sometimes correct address fails but works on second try\n\t\t\tif ( !g.ok ) { g = geocode( location ); }\n\t\t\tif ( g.ok ) { geocode_ok = true; }\n\t\t}\n\t}\n\tif ( geocode_ok )\n\t{\n\t\turl = webapi( 'nsrdb_query' );\n\t\turl = replace( url, '<LAT>', g.lat );\n\t\turl = replace( url, '<LON>', g.lon );\n\t\t//url = replace( url, '<LAT>', 'xxx' );\n\t\t//url = replace( url, '<LON>', 'yyy' );\n\t\tjson_str = curl( url );\n\t\tmsg += 'Latitude / longitude for NSRDB Data Query: ' + g.lat + ',' + g.lon +  '\\n\\n';\n\t\tmsg += 'URL for NSRDB Data Query: ' + url + '\\n\\n';\n\t\tvar = json_read( json_str );\n\t\tif ( typeof( var ) == 'table' )\n\t\t{\n\t\t\tif ( var.errors != null)\n\t\t\t{\n\t\t\t\tif ( #var.errors > 0 )\n\t\t\t\t{\n\t\t\t\t\tmsg += 'Message from NSRDB Data Query: ' + var.errors[0] + '.\\nStatus = ' + var.status;\n\t\t\t\t}\n\t\t\t\telse { json_ok = true; }\t\n\t\t\t}\n\t\t\telseif ( var.error != null )\n\t\t\t{\n\t\t\t\tif ( #@var.error > 0 )\n\t\t\t\t{\n\t\t\t\t\tmsg += 'NSRDB Data Query Error: ' + var.error.message + '.\\nCode = ' + var.error.code;\n\t\t\t\t\tif ( strpos( lower(var.code), 'api' ) > -1 ) { msg += 'See private.h to set API keys.'; }\n\t\t\t\t}\t\n\t\t\t}\n\t\t\telseif ( var.outputs == null )\n\t\t\t{\n\t\t\t\tmsg += 'NSRDB Data Query returns no data for \\\"' + location + '\\\" (outputs = null).\\nSee https://sam.nrel.gov/weather for links to other data sources.\\n';\n\t\t\t}\n\t\t\telseif ( var.outputs == [] )\n\t\t\t{\n\t\t\t\tmsg += 'NSRDB Data Query returns no data for \\\"' + location + '\\\" (outputs = []).\\nSee https://sam.nrel.gov/weather for links to other data sources.\\n';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tjson_ok = true;\n\t\t\t}\t\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmsg += 'NSRDB Data Query did not return valid JSON string:\\n';\n\t\t\tmsg += json_str;\n\t\t}\n\t\tif ( json_ok )\n\t\t{\n\t\t\tavailable_datasets = var.outputs;\n\t\t\t// list of datasets that don't require advanced download\n\t\t\t// not all datasets work with SAM, for example spectral-india-tmy\n\t\t\tvalid_datasets = 'psm3,psm3-tmy,msg-iodc,suny-india,suny-india-tmy'; \n\t\t\tfor ( i=0; i<#available_datasets; i++ )\n\t\t\t{\n\t\t\t\tavailable_names[i] = available_datasets[i].name;\n\t\t\t\tif ( strpos(available_datasets[i].name, 'suny') > -1 ) { is_suny = true;}\n\t\t\t}\n\t\t\ti_dataset = -1;\n\t\t\tfor ( i=0; i<#available_datasets; i++ )\n\t\t\t{\n\t\t\t\tif ( strpos(valid_datasets,available_datasets[i].name) > - 1 )\n\t\t\t\t{\n\t\t\t\t\tif ( is_tmy && (available_datasets[i].name == 'psm3-tmy' || available_datasets[i].name == 'suny-india-tmy') )\n\t\t\t\t\t{\n\t\t\t\t\t\ti_dataset = i;\n\t\t\t\t\t}\n\t\t\t\t\telseif ( !is_tmy && ( available_datasets[i].name == 'suny-india' || available_datasets[i].name == 'psm3' ) )\n\t\t\t\t\t{\n\t\t\t\t\t\ti_dataset = i;\n\t\t\t\t\t}\n\t\t\t\t\telseif ( !is_tmy && !is_suny && available_datasets[i].name == 'msg-iodc' )\n\t\t\t\t\t{\n\t\t\t\t\t\ti_dataset = i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\t\n\t\t\tif ( i_dataset == -1 )\n\t\t\t{\n\t\t\t\tstr_tmy = '';\n\t\t\t\tif ( is_tmy ) { str_tmy = 'TMY'; }\n\t\t\t\tmsg += 'No ' + str_tmy + ' file available for \\\"' + location + '\\\". (Avalaible datasets: ' + available_names + ')\\n\\n';\n\t\t\t\tmsg += 'Try the Advanced Download option or see https://sam.nrel.gov/weather for other sources of data.\\n';\n\t\t\t\tdataset_ok = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tname = var.outputs[i_dataset].name;\n\t\t\t\turl = var.outputs[i_dataset].apiUrl+'.csv';\n\t\t\t\tyears = var.outputs[i_dataset].availableYears;\n\t\t\t\tdataset_ok = true;\n\t\t\t}\n\t\t}\n\t\t//else { msg += 'JSON tests failed. There may be a problem with the service.'; }\n\t}\n\telse\n\t{\n\t\tgeocode_ok = false;\n\t\tmsg += 'Geocoding failed: Could not connect to service or failed to recognize \\\"' + location + '\\\" \\n';\n\t}\n\tok_test = ( ( geocode_ok == true ) && ( json_ok == true ) && ( dataset_ok == true ) && ( location_ok == true ) );\n\treturn { 'name' = name , 'msg' = msg , 'is_suny' = is_suny, 'url' = url, 'years' = years , 'ok' = ok_test , 'lat' = g.lat, 'lon' = g.lon };\n}\n\nfunction wf_check( wf )\n{\n\tif ( file_exists( wf ) )\n\t{\n\t\tssc = ssc_create();\n\t\tssc_var( ssc, 'input_file', wf );\n\t\tresult = ssc_exec( ssc, 'wfcheck', {'show_dialog'=false} );\n\t\tresult = to_string( result );\n\t\tssc_free( ssc );\n\t}\n\telse\n\t{\n\t\tresult = 'Weather file checker could not find file: ' + wf ;\n\t}\n\treturn result;\n}\n\n// returns a weather file for the current NSRDB data available for a location\nfunction nsrdb_get()\n{\n\tenum { TMY, SINGLE_YEAR, ALL_YEARS };\n\tenum { ONE_LOCATION, MULTIPLE_LOCATIONS };\n\tenum { HOURLY, HALF_HOURLY };\n\tmsg = '';\n\tdownload_ok = true;\n\tlocation_ok = true;\n\tfolder = slash_back_to_forward( wfdownloaddir() );\n\tlog_file = folder + '/sam_nsrdb_download_log.txt';\n\tif ( file_exists( log_file ) ) { flog = open( log_file , 'a' ); }\n\telse { flog = open( log_file, 'w' ); }\n\twrite_line( flog, 'NSRDB Download ' + date_time());\n\twrite_line( flog, '==========================================================\\n');\t\n\tif ( value( 'in_location_options' ) == ONE_LOCATION )\n\t{\t\n\t\tlocation = [ value('in_location') ];\n\t}\n\telse\n\t{\n\t\tlocation_list = value('in_location_list'); // string with '|' delimiter\n\t\tlocation_list = replace( location_list, '\\\"', '' ); // files from spreadsheets may use quotes for strings\n\t\tlocation = split(location_list, '|');\n\t}\n\tdownload_option = value('in_nsrdb_options');\n\tif ( value( 'in_time_step' ) == HOURLY || download_option == TMY ) // tmy is always hourly\n\t{\t\n\t\ttime_step = '60'; \n\t}\n\telse\n\t{\n\t\ttime_step = '30'; \n\t}\n\twrite_line( flog, 'Requested location(s): ' + location + '\\n');\n\tpb_locations = progressbar( { 'title' = 'Download Progress' , 'message' = 'Starting download.' , 'cancelbutton' = false , 'closebutton' = false , 'time' = false , 'max' = #location } );\n\tfor ( n=0; n<#location; n++ )\n\t{\n\t\twrite_line( flog, 'Location ' + to_string(n+1) + ' of ' + #location + ': \\\"' + location[n]  + '\\\"');\n\t\twrite_line( flog, '----------------------------------------------------------\\n');\t\n\t\tprogressbar( pb_locations, { 'message' = 'Getting download information for \\\"' + location[n] + '\\\".' , 'value' = 1+n } );\n\t\tdataset[n] = nsrdb( location[n], download_option == TMY );\n\t\tprogressbar( pb_locations, { 'message' = 'Processing download information for \\\"' + location[n] + '\\\".' , 'value' = 1+n } );\n\t\tif ( !dataset[n].ok )\n\t\t{\n\t\t\tdownload_ok = false;\n\t\t\twrite_line( flog, dataset[n].msg + '\\n');\n\t\t\tmsg += dataset[n].msg + '\\n';\n\t\t\tcontinue;\n\t\t}\t\n\t\tif ( download_option == TMY ) // this needs to work for both psm3-tmy and suny-india-tmy\n\t\t{\t\n\t\t\ttype = ['tmy']; // should get newest TMY file for psm3-tmy, or tmy for suny-india-tmy\n\t\t}\n\t\telseif ( download_option == SINGLE_YEAR ) \n\t\t{\n\t\t\tif ( dataset[n].is_suny && time_step != '60' )\n\t\t\t{\n\t\t\t\tmsgbox('Only 60-minute data is available for suny-india dataset.\\nTry the Advanced Download option to see of other datasets are available for this location.');\n\t\t\t\tdownload_ok = false;\n\t\t\t\twrite_line( flog, 'Only 60-minute data available for suny-india dataset.\\n' );\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\ty = choose_from_list( dataset[n].years, 'Choose a year', 'Available Years for \\\"' + location[n] +'\\\"', 0 ); \n\t\t\tif (y == '')\n\t\t\t{\n\t\t\t\tdownload_ok = false;\n\t\t\t\twrite_line( flog, 'Year not valid: Selection cancelled by user.\\n' );\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse\t\n\t\t\t{\t\n\t\t\t\ttype = [to_int( y )]; \n\t\t\t}\n\t\t}\n\t\telse // all years\n\t\t{\t\n\t\t\ttype = dataset[n].years; \n\t\t}\n\t\twrite_line( flog, 'Requested year(s): ' + type );\n\t\tif ( dataset[n].ok )\n\t\t{ \n\t\t\tbase_url = dataset[n].url;\n\t\t\tbase_url += '?api_key=<SAMAPIKEY>';\n\t\t\tbase_url += '&full_name=sam_user';\n\t\t\tbase_url += '&email=<USEREMAIL>';\n\t\t\tbase_url += '&affiliation=unknown'; \n\t\t\tbase_url += '&mailing_list=false';\n\t\t\tbase_url += '&reason=SAM';\n\t\t\tbase_url += '&interval=' + time_step;\n\t\t\tbase_url += '&utc=false';\n\t\t\tbase_url += '&leap_day=false';\n\n\t\t\t// create folder for multiple years to facilitate\n\t\t\t// p50 p90 and add to library folders list\n\t\t\t// do not put tmy file in multiple year folder\n\t\t\t// use default folder if mdkir() fails\n\t\t\tdefault_download_path = slash_back_to_forward( folder );\n\t\t\ttmy_path = slash_back_to_forward( default_download_path );\n\t\t\tpath = slash_back_to_forward( default_download_path );\n\t\t\tif ( #type > 1 )\n\t\t\t{\n\t\t\t\tpath = path + '/' + clean_name( location[n] ) ;\n\t\t\t\tif ( !dir_exists( path ) )\n\t\t\t\t{\n\t\t\t\t\tif ( !mkdir( path, false ) )\n\t\t\t\t\t{\tpath = default_download_path; }\n\t\t\t\t}\n\t\t\t\tif ( path != default_download_path /*&& i == 0*/)\n\t\t\t\t{\tupdate_library_folders( path ); }\n\t\t\t}\n\t\t\t\n\t\t\tpb_years = progressbar( { 'title' = 'Download Progress for ' + location[n] , 'message' = 'Downloading, please wait...', 'cancelbutton' = false , 'closebutton' = false , 'time' = false , 'max' = #type } );\n\t\t\t\t\n\t\t\t// for each year\n\t\t\tbase = base_url;\n\t\t\tfor( i=0; i<#type; i++ )\n\t\t\t{\n\t\t\t\tbase_url = base;\n\t\t\t\tprogressbar( pb_years, { 'message' = 'Preparing file ' + to_string(i+1) + ' of ' + #type + '.' , 'value' = 1+i } );\n\t\t\t\tfile_skipped = false;\n\t\t\t\tno_current_data = false;\n\t\t\t\t// only get attributes SAM needs for simulations\n\t\t\t\t// otherwise default is to get all attributes\n\t\t\t\t// https://developer.nrel.gov/docs/solar/nsrdb/\n\t\t\t\tif ( dataset[n].name == 'psm3')\n\t\t\t\t{\n\t\t\t\t\tbase_url += '&attributes=dni,dhi,ghi,dew_point,air_temperature,surface_pressure,relative_humidity,wind_direction,wind_speed,surface_albedo';\n\t\t\t\t}\n\t\t\t\telseif ( dataset[n].name == 'psm3-tmy')\n\t\t\t\t{\n\t\t\t\t\tbase_url += '&attributes=dni,dhi,ghi,dew_point,air_temperature,surface_pressure,wind_direction,wind_speed,surface_albedo';\n\t\t\t\t}\n\t\t\t\telseif ( dataset[n].name == 'suny-india' )\n\t\t\t\t{\n\t\t\t\t\tbase_url += '&attributes=dni,dhi,ghi,dew_point,surface_temperature,surface_pressure,relative_humidity,wdir,wspd,snow_depth';\n\t\t\t\t}\n\t\t\t\telseif ( dataset[n].name == 'suny-india-tmy' )\n\t\t\t\t{\n\t\t\t\t\tbase_url += '&attributes=dni,dhi,ghi,dew_point,air_temperature,surface_pressure,wind_direction,wind_speed';\n\t\t\t\t}\n\t\t\t\telseif ( dataset[n].name == 'msg-iodc' )\n\t\t\t\t{\n\t\t\t\t\tbase_url += '&attributes=dni,dhi,ghi,dew_point,air_temperature,surface_pressure,relative_humidity,wind_direction,wind_speed,surface_albedo';\n\t\t\t\t}\n\t\t\t\twrite_line( flog, '\\nFile ' + to_string(i+1) + ' of ' + #type + ': ' + type[i]);\n\t\t\t\twrite_line( flog, '----------------------------------------------------------\\n');\t\n\t\t\t\turl = base_url + '&names=' + to_string(type[i]);\n\t\t\t\turl += '&wkt=POINT(' + dataset[n].lon + '%20' + dataset[n].lat + ')';\n\t\t\t\twrite_line( flog, url + '\\n');\n\t\t\t\tfname = path + '/' + clean_name( location[n] ) + '_' + dataset[n].lat + '_' + dataset[n].lon + '_' + dataset[n].name + '_' + time_step + '_' + type[i] + '.csv';\n\t\t\t\tif ( type[i] == 'tmy' ) \n\t\t\t\t{\n\t\t\t\t\tfname = replace( fname, path, tmy_path ); \n\t\t\t\t\tfname_tmy = fname;\n\t\t\t\t}\n\t\t\t\tif ( solar_library( fname, false ){'is_in_library'} )\n\t\t\t\t{\n\t\t\t\t\tfile_skipped = true;\n\t\t\t\t\tstr = 'File skipped, already exists: ' + fname + '\\n';\n\t\t\t\t\twrite_line( flog, str );\n\t\t\t\t\tmsg += str + '\\n';\n\t\t\t\t\tif ( #location == 1 )\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue( 'solar_resource', file_to_key( fname ) );\n\t\t\t\t\t}\t\n\t\t\t\t}\n\t\t\t\telse // elseif ( !no_current_data )\t\n\t\t\t\t{\n\t\t\t\t\twf_error = '';\n\t\t\t\t\tstart = start_timer();\n\t\t\t\t\tprogressbar( pb_years, { 'message' = 'Downloading file ' + to_string(i+1) + ' of ' + #type + '.' , 'value' = 1+i } );\n\t\t\t\t\tcurl_ok = curl( url , { 'file'= fname } ); // curl() should replace <SAMAPI> from private.h and <USEREMAIL > from registry\n\t\t\t\t\ttime = elapsed_time() / 1000;\n\t\t\t\t\twrite_line( flog, 'Download time: ' + time + ' seconds.\\n' );\n\t\t\t\t\tprogressbar( pb_years, { 'message' = 'Checking file ' + to_string(i+1) + ' of ' + #type + '.' , 'value' = 1+i } );\n\t\t\t\t\tif ( !curl_ok )\n\t\t\t\t\t{\n\t\t\t\t\t\tdownload_ok = false;\n\t\t\t\t\t\twrite_line( flog, 'Failed to download file from NSRDB: cURL failed.');\n\t\t\t\t\t\tmsg += ('Failed to download weather file ' + fname + '\\n');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\twf_error = wf_check( fname );\n\t\t\t\t\t\tif ( wf_error != \"0\" ) // usually indicates NSRDB returned a file containing error message instead of weather data\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdownload_ok = false;\n\t\t\t\t\t\t\twrite_line( flog, 'Weather file test failed, ' + wf_error + ': ' + fname + '.\\n');\n\t\t\t\t\t\t\tfile_text = read_text_file( fname );\n\t\t\t\t\t\t\tif ( #file_text < 1000 ) // probably JSON returned by NSRDB\n\t\t\t\t\t\t\t{ \n\t\t\t\t\t\t\t\tvar_err = json_read( file_text );\n\t\t\t\t\t\t\t\tif ( strpos( var_err, 'json-error') > -1 ) // JSON not valid (could be HTML message from server)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tmsg += 'Expected JSON from NSRDB is not valid. This could indicate that the NSRDB service is down.';\n\t\t\t\t\t\t\t\t\tif ( strpos( file_text, '<html>') > -1 )\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\thtml_dialog( file_text, 'Message from NSRDB' );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse // valid JSON with error message\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tmsg += 'Error message from NSRDB: \\n' + var_err.errors[0] +'\\n\\n';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\twrite_line( flog, 'Text from file:\\n' +  file_text );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tmsg += 'Weather file test failed for ' + file_only( fname ) + '.\\n';\n\t\t\t\t\t\t\tfname_new = replace( fname, '.csv' , '_bad.txt' ); // rename file so next download attempt won't detect existing file\n\t\t\t\t\t\t\tok = rename_file( fname , fname_new );\n\t\t\t\t\t\t\tif ( ok )\n\t\t\t\t\t\t\t{ \n\t\t\t\t\t\t\t\twrite_line( flog, '* File renamed to: ' + fname_new + '.\\n' );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\twrite_line( flog, '* Failed to rename ' + fname + '.\\n' );\t\n\t\t\t\t\t\t\t}\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// set library to last file that was downloaded and passed weather file test\n\t\t\t\t\t\telseif ( i == #type - 1 ) \n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trescanlibrary('solar');\n\t\t\t\t\t\t\tfn = fname;\n\t\t\t\t\t\t\tvalue( 'solar_resource', file_to_key( fn ) );\n\t\t\t\t\t\t\twrite_line( flog, 'Weather file test passed: ' + fname + '.\\n');\n\t\t\t\t\t\t}\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\t\n\t\t\tprogressbar( pb_years );\n\t\t}\t\n\t\telse\n\t\t{\n\t\t\tdownload_ok = false;\n\t\t\twrite_line( flog, dataset[n].msg + '\\n');\n\t\t}\n\t}\n\tprogressbar( pb_locations );\n\tclose ( flog );\n\tif ( download_ok && #type > 1 ) // multiple years\n\t{\n\t\tstr = 'Download complete!\\n';\n\t\tstr += 'Multiple single-year files downloaded to:\\n  ' + path + '\\n\\n';\n\t\tstr += 'Do you want to show instructions for running a P50/P90 analysis now?';\n\t\tif ( yesno( str ) )\n\t\t{\n\t\t\tfolder = path;\n\t\t\tp50p90_text = 'Instructions for running P50/P90 simulations:\\n\\n'\n\t\t\t+ '1. Click P50 / P90 at the bottom left of the main SAM window.\\n\\n'\n\t\t\t+ '2. Click the ellipses (...) to the right of the Select Weather File Folder box.\\n\\n'\n\t\t\t+ '3. Navigate to ' + folder + '.\\n\\n'\n\t\t\t+ '4. Click \"Run P50/P90 simulations\".\\n'\n\t\t\t+ '\\nIf you want to set a custom P value in addition to P10, P50 and P90, you can type a value for \"Custom Px\" before running the simulations.'\n\t\t\t+ '\\n\\nTo remove this note window, delete all of its contents and close the window.';\n\t\t\tpagenote( p50p90_text );\n\t\t}\n\t}\n\telseif ( download_ok && !file_skipped && !no_current_data )\n\t{\n\t\tstr = 'Download complete!\\n';\n\t\tstr += 'Weather file(s) downloaded to:\\n' + path + '.\\n';\n\t\tstr += '\\nOpen log file?';\n\t\tshow_log = yesno( str );\n\t\tif ( show_log ) { browse( log_file ); }\n\t}\n\telseif ( download_ok && file_skipped )\n\t{\n\t\tstr = 'File already in library.\\n Download skipped.\\n\\n' + fname;\n\t\tmsgbox( str );\n\t}\n\telse \n\t{\n\t\tshow_log = yesno( 'Download Messages\\n' + msg + '\\nOpen log file?');\n\t\tif ( show_log ) { browse( log_file ); }\n\t}\n}"
}