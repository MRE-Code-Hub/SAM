Marine Array
1038
1056
56
GroupBox

1
8
Name
5
11
GroupBox222
X
3
6
Y
3
3
Width
3
788
Height
3
110
Tool Tip
5
0
Caption
5
13
System Sizing
Bold
2
1
GroupBox

1
8
Name
5
9
GroupBox4
X
3
6
Y
3
120
Width
3
1007
Height
3
899
Tool Tip
5
0
Caption
5
12
Array Layout
Bold
2
1
RadioChoice

1
11
Name
5
17
array_sizing_mode
X
3
21
Y
3
24
Width
3
258
Height
3
72
Tool Tip
5
0
Selection
3
0
Items
6
3
Use a single device
Specify desired rated capacity
Specify number of devices
ShowCaptions
2
1
Horizontal
2
0
TabOrder
3
4294967295
RadioChoice

1
11
Name
5
19
cable_length_option
X
3
411
Y
3
609
Width
3
318
Height
3
45
Tool Tip
5
0
Selection
3
0
Items
6
2
Calculate cable lengths
Enter cable lengths
ShowCaptions
2
1
Horizontal
2
1
TabOrder
3
4294967295
Numeric

1
17
Name
5
22
cable_system_overbuild
X
3
258
Y
3
378
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
Numeric

1
17
Name
5
18
desired_array_size
X
3
483
Y
3
18
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
21
device_spacing_in_row
X
3
258
Y
3
207
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
5
Numeric

1
17
Name
5
15
devices_per_row
X
3
258
Y
3
183
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4
Numeric

1
17
Name
5
22
distance_to_shore_file
X
3
258
Y
3
288
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
23
distance_to_shore_input
X
3
258
Y
3
288
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
5
Numeric

1
17
Name
5
19
export_cable_length
X
3
255
Y
3
633
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
5
CheckBox

1
9
Name
5
23
export_cable_redundancy
X
3
258
Y
3
429
Width
3
27
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
1
TabOrder
3
4294967295
Numeric

1
17
Name
5
20
export_cable_voltage
X
3
210
Y
3
795
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Choice

1
9
Name
5
27
export_cable_voltage_choice
X
3
210
Y
3
828
Width
3
90
Height
3
24
Tool Tip
5
0
Items
6
3
Use calculated choice
Set to AC
Set to HVDC
Selection
3
4294967295
TabOrder
3
4294967295
Label

1
13
Name
5
24
export_cable_voltage_lbl
X
3
327
Y
3
795
Width
3
39
Height
3
24
Tool Tip
5
0
Caption
5
0
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
RadioChoice

1
11
Name
5
30
export_cable_voltage_option_ac
X
3
366
Y
3
783
Width
3
650
Height
3
42
Tool Tip
5
0
Selection
3
0
Items
6
9
7.2 kV
12 kV
24 kV
36 kV
66 kV
72.5 kV
145 kV
220 kV
400 kV
ShowCaptions
2
1
Horizontal
2
1
TabOrder
3
4294967295
RadioChoice

1
11
Name
5
32
export_cable_voltage_option_hvdc
X
3
366
Y
3
783
Width
3
261
Height
3
42
Tool Tip
5
0
Selection
3
0
Items
6
2
150 kV
300 kV
ShowCaptions
2
1
Horizontal
2
1
TabOrder
3
4294967295
CheckBox

1
9
Name
5
14
floating_array
X
3
258
Y
3
402
Width
3
27
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
1
TabOrder
3
4294967295
Numeric

1
17
Name
5
24
inter_array_cable_length
X
3
255
Y
3
609
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4
Numeric

1
17
Name
5
25
inter_array_cable_voltage
X
3
210
Y
3
717
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
RadioChoice

1
11
Name
5
32
inter_array_cable_voltage_option
X
3
366
Y
3
705
Width
3
501
Height
3
42
Tool Tip
5
0
Selection
3
0
Items
6
6
Calculated
7.2 kV
12 kV
24 kV
36 kV
66 kV
ShowCaptions
2
1
Horizontal
2
1
TabOrder
3
4294967295
Label

1
13
Name
5
19
layout_instructions
X
3
621
Y
3
21
Width
3
165
Height
3
78
Tool Tip
5
0
Caption
5
70
Specify the number of devices using the Array Layout parameters below.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Numeric

1
17
Name
5
17
load_grid_voltage
X
3
207
Y
3
957
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Choice

1
9
Name
5
25
load_grid_voltage_options
X
3
321
Y
3
957
Width
3
90
Height
3
24
Tool Tip
5
0
Items
6
6
Extra Low Voltage (kV < 4)
Low Voltage (4 ≤ kV ≤ 34)
Medium Voltage (34 ≤ kV ≤ 69)
High Voltage (69 ≤ kV ≤ 138)
Extra High Voltage (138 ≤ kV ≤ 345)
Ultra High Voltage (345 ≤ kV ≤ 765)
Selection
3
4294967295
TabOrder
3
4294967295
Plot

1
6
Name
5
14
mhk_array_plot
X
3
411
Y
3
147
Width
3
340
Height
3
320
Tool Tip
5
0
Numeric

1
17
Name
5
14
number_devices
X
3
483
Y
3
45
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
11
number_rows
X
3
258
Y
3
159
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
MultilineText

1
11
Name
5
9
object 10
X
3
303
Y
3
894
Width
3
90
Height
3
24
Tool Tip
5
0
Text
5
3
Yes
Editable
2
0
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Image

1
8
Name
5
9
object 12
X
3
564
Y
3
447
Width
3
40
Height
3
64
Tool Tip
5
0
Image
7
Marine Array_object 12.png
Centered
2
1
Divider

1
10
Name
5
9
object 21
X
3
42
Y
3
870
Width
3
510
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
32
Substation / Load Specifications
Bold
2
1
Divider

1
10
Name
5
11
object 2110
X
3
39
Y
3
693
Width
3
510
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
22
Assumed Cable Voltages
Bold
2
1
Divider

1
10
Name
5
11
object 2118
X
3
42
Y
3
588
Width
3
333
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
24
Calculated Cable Lengths
Bold
2
1
Divider

1
10
Name
5
9
object 22
X
3
18
Y
3
534
Width
3
369
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
20
Cable Specifications
Bold
2
1
Label

1
13
Name
5
8
object 7
X
3
429
Y
3
957
Width
3
447
Height
3
24
Tool Tip
5
0
Caption
5
47
Only required if onshore substation is required
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
10
object 719
X
3
603
Y
3
474
Width
3
120
Height
3
24
Tool Tip
5
0
Caption
5
14
Wave direction
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
10
object 742
X
3
405
Y
3
507
Width
3
386
Height
3
57
Tool Tip
5
0
Caption
5
77
Row spacing affects calculated cable lengths but not array energy production.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
9
object 78
X
3
45
Y
3
927
Width
3
162
Height
3
24
Tool Tip
5
0
Caption
5
27
Onshore substation required
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
9
object 79
X
3
45
Y
3
894
Width
3
162
Height
3
24
Tool Tip
5
0
Caption
5
28
Offshore substation required
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Choice

1
9
Name
5
26
offshore_substation_choice
X
3
207
Y
3
894
Width
3
90
Height
3
24
Tool Tip
5
0
Items
6
3
Use calculated choice
Set to Yes
Set to No
Selection
3
4294967295
TabOrder
3
4294967295
MultilineText

1
11
Name
5
22
onshore_substation_msg
X
3
303
Y
3
927
Width
3
90
Height
3
24
Tool Tip
5
0
Text
5
2
No
Editable
2
0
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
18
riser_cable_length
X
3
255
Y
3
657
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
Numeric

1
17
Name
5
19
riser_cable_voltage
X
3
210
Y
3
753
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
RadioChoice

1
11
Name
5
26
riser_cable_voltage_option
X
3
366
Y
3
741
Width
3
417
Height
3
42
Tool Tip
5
0
Selection
3
0
Items
6
5
Calculated
7.2 kV
12 kV
24 kV
36 kV
ShowCaptions
2
1
Horizontal
2
1
TabOrder
3
4294967295
Numeric

1
17
Name
5
11
row_spacing
X
3
258
Y
3
231
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
Label

1
13
Name
5
14
sizing_warning
X
3
621
Y
3
21
Width
3
165
Height
3
81
Tool Tip
5
0
Caption
5
79
It is not possible to reach the desired array capacity exactly for this device.
TextColour
4
255
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Numeric

1
17
Name
5
15
system_capacity
X
3
483
Y
3
72
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
CheckBox

1
9
Name
5
22
use_onshore_substation
X
3
228
Y
3
927
Width
3
48
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
1
TabOrder
3
4294967295
CheckBox

1
9
Name
5
20
use_wavefile_spacing
X
3
258
Y
3
258
Width
3
27
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
4294967295
Label

1
13
Name
5
26
use_wavefile_spacing_label
X
3
9
Y
3
258
Width
3
246
Height
3
24
Tool Tip
5
0
Caption
5
34
Use values from wave resource file
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Numeric

1
17
Name
5
24
user_export_cable_length
X
3
255
Y
3
633
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
26
user_input_devices_per_row
X
3
258
Y
3
183
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4
Numeric

1
17
Name
5
22
user_input_number_rows
X
3
258
Y
3
159
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
29
user_inter_array_cable_length
X
3
255
Y
3
609
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
23
user_riser_cable_length
X
3
255
Y
3
657
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
16
water_depth_file
X
3
258
Y
3
312
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
17
water_depth_input
X
3
258
Y
3
312
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6

37
array_sizing_mode
3
1
Array sizing mode
 
ME Array
76
Use a single device|Specify desired rated capacity|Specify number of devices
3
1
1
1
1
0
Image
cable_length_option
3
1
Calculate or enter cable lengths
0/1
ME Array
0
3
1
1
1
1
0
RadioChoice
cable_system_overbuild
3
1
Cable system overbuild
%
ME Array
0
2
1
1
1
1
10
Numeric
desired_array_size
3
1
Desired rated capacity
kW
ME Array
0
2
1
1
1
1
0
Numeric
device_spacing_in_row
3
1
Spacing between devices in a row
m
ME Array
0
2
1
1
1
1
600
Numeric
devices_per_row
3
1
Devices per row
 
ME Array
0
8
1
1
1
1
10
Numeric
distance_to_shore
3
1
Distance to shore
m
ME Array
0
8
1
1
1
1
5000
Numeric
distance_to_shore_input
3
1
Distance to shore
m
ME Array
0
2
1
1
1
1
0
Numeric
export_cable_length
3
1
Export cable length
m
ME Array
0
8
1
1
1
1
0
Numeric
export_cable_redundancy
3
1
Build export cable redundancy
 
ME Array
0
2
1
1
1
1
0
CheckBox
export_cable_voltage
3
1
Export cable voltage
kV
ME Array
0
8
1
1
1
1
0
Default
export_cable_voltage_choice
3
1
Override calculated AC/HVDC option for export cables
0/1
ME Array
43
Use calculated values|Set to AC|Set to HVDC
3
1
1
1
1
0
CheckBox
export_cable_voltage_option_ac
3
1
Export cable voltage AC option
 
ME Array
33
Default|7.2kV|12kV|24kV|36kV|66kV
3
1
1
1
1
0
RadioChoice
export_cable_voltage_option_hvdc
3
0
 
 
 
0
0
1
0
Default
floating_array
3
1
Floating array
 
ME Array
0
2
1
1
1
1
1
CheckBox
inter_array_cable_length
3
1
Inter-array cable length
m
ME Array
0
8
1
1
1
1
0
Numeric
inter_array_cable_voltage
3
1
Inter-array cable voltage
kV
ME Array
0
8
1
1
1
1
0
Default
inter_array_cable_voltage_option
3
0
Inter-array cable voltage option
 
ME Array
33
Default|7.2kV|12kV|24kV|36kV|66kV
3
1
0
RadioChoice
load_grid_voltage
3
1
Load / grid voltage
kV
ME Array
0
8
1
1
1
1
0
Default
load_grid_voltage_options
3
1
Load grid voltage options
kV
ME Array
0
3
1
1
1
1
0
Choice
number_devices
3
1
Number of devices in array
 
ME Array
0
8
1
1
1
1
100
Numeric
number_rows
3
1
Number of rows
 
ME Array
0
8
1
1
1
1
10
Numeric
offshore_substation_choice
3
1
Offshore substation cost choice
 
ME Array
42
Use calculated choice|Set as Yes|Set as No
1
1
1
1
1
0
Default
riser_cable_length
3
1
Riser cable length
m
ME Array
0
8
1
1
1
1
0
Numeric
riser_cable_voltage
3
1
Riser cable voltage
kV
ME Array
0
8
1
1
1
1
0
Default
riser_cable_voltage_option
3
1
Riser cable voltage option
 
ME Array
33
Default|7.2kV|12kV|24kV|36kV|66kV
3
1
1
1
1
0
RadioChoice
row_spacing
3
1
Row spacing
m
ME Array
0
2
1
1
1
1
600
Numeric
system_capacity
3
1
Rated array capacity
kW
ME Array
0
8
1
1
1
1
0
Numeric
use_onshore_substation
3
1
 
 
 
0
8
1
1
1
1
0
Default
use_wavefile_spacing
3
1
Use values from wave resource file
0/1
ME Array
0
3
1
1
1
1
0
CheckBox
user_export_cable_length
3
1
Export cable length
m
ME Array
0
0
1
1
1
1
0
Default
user_input_devices_per_row
3
1
Devices per row
 
ME Array
0
2
1
1
1
1
10
Numeric
user_input_number_rows
3
1
Number of rows
 
ME Array
0
2
1
1
1
1
3
Numeric
user_inter_array_cable_length
3
1
Inter-array cable length
m
ME Array
0
2
1
1
1
1
0
Numeric
user_riser_cable_length
3
1
Riser cable length
m
ME Array
0
2
1
1
1
1
0
Numeric
water_depth
3
1
Water depth
m
ME Array
0
8
1
1
1
1
50
Numeric
water_depth_input
3
1
Water depth
m
ME Array
0
2
1
1
1
1
0
Numeric

3975
equations{ 'system_capacity' } = define() {
	return ${number_devices} * ${device_rated_power};
};

equations{ '$MIMO$ cable_length' } = define() {

	data.devices_per_row = ${devices_per_row};
	data.device_spacing_in_row = ${device_spacing_in_row};
	data.number_rows = ${number_rows};
	data.row_spacing = ${row_spacing};
	data.cable_system_overbuild = ${cable_system_overbuild};
	data.water_depth = ${water_depth};
	data.number_devices = ${number_devices};
	data.distance_to_shore = ${distance_to_shore};
	data.floating_array = ${floating_array};
	data.export_cable_redundancy = ${export_cable_redundancy};
	
	success = ssc_eqn("me_array_cable_length", data);
	
	if (!success){
		msgbox("error = " + success);
		return 0;
	}
	//msgbox(data);
	if (${cable_length_option} == 0) {
		${inter_array_cable_length} = data.inter_array_cable_length;
		${export_cable_length} = data.export_cable_length;
		${riser_cable_length} = data.riser_cable_length;
	}
	else {
		${inter_array_cable_length} = ${user_inter_array_cable_length};
		${export_cable_length} = ${user_export_cable_length};
		${riser_cable_length} = ${user_riser_cable_length};
	}
	
	data.inter_array_cable_length = ${inter_array_cable_length};
	data.riser_cable_length = ${riser_cable_length};
	data.export_cable_length = ${export_cable_length};
	data.system_capacity = ${system_capacity};
	data.device_rated_power = ${device_rated_power};
	data.use_onshore_substation = ${use_onshore_substation};
	data.load_grid_voltage = ${load_grid_voltage};
	
	success = ssc_eqn("me_array_cable_voltage", data);
	
	if (!success){
		msgbox("error = " + success);
		return 0;
	}
	
	${inter_array_cable_voltage} = data.inter_array_cable_voltage;
	${export_cable_voltage} = data.export_cable_voltage;
	${riser_cable_voltage} = data.riser_cable_voltage;

	return 0;
};

equations{'load_grid_voltage'} = define() {
	if (${load_grid_voltage_options} == 0) return 7.2;
	else if (${load_grid_voltage_options} == 1) return 36;
	else if (${load_grid_voltage_options} == 2) return 66;
	else if (${load_grid_voltage_options} == 3) return 145;
	else if (${load_grid_voltage_options} == 4) return 220;
	else if (${load_grid_voltage_options} == 5) return 400;
};


equations{ '$MIMO$ MHKFarmLayout' } = define() {
	if (${array_sizing_mode} == 0) //single device
	{
		${number_rows} = 1;
		${devices_per_row} = 1;
	}
	else if (${array_sizing_mode} == 1) //specify nameplate
	{
		num = round(${desired_array_size} / ${device_rated_power});
		if (num <=1) num = 1;
		//assume they're laid out in roughly a square
		rows = floor(sqrt(num));
		cols = num/rows;
		while (rows * floor(cols) != num) //if not evenly divisible
		{
			rows -=1; //decrease the number of rows until it does divide evenly 
			// if number devices is prime, this will continue until rows = 1
			cols = num/rows;
		}
		${number_rows} = rows;
		${devices_per_row} = cols;
	}
	else //specify layout
	{
		${number_rows} = ${user_input_number_rows};
		${devices_per_row} = ${user_input_devices_per_row};
	}
};

equations {'number_devices'} = define() {
	return ${number_rows} * ${devices_per_row};
};

equations {'distance_to_shore'} = define() {
	model_choice = 0;
	if ((technology() == "MEwave" || technology() == "MEwave Battery" ) && 
		financing() != "Single Owner")
		if (${wave_resource_model_choice} == 1)
			model_choice = 1;
	if (technology() == "MEwave" && model_choice == 1) {
		if (${use_wavefile_spacing}==0) {
			return ${distance_to_shore_input};
		}
		else return ${distance_to_shore_file};
	}
	else return ${distance_to_shore_input};
};

equations {'water_depth'} = define() {
	model_choice = 0;
	if ((technology() == "MEwave" || technology() == "MEwave Battery" ) &&
		financing() != "Single Owner")
		if (${wave_resource_model_choice} == 1)
			model_choice = 1;
	if (technology() == "MEwave" && model_choice == 1) {
		if (${use_wavefile_spacing}==0) {
			return ${water_depth_input};
		}
		else return ${water_depth_file};
	}
	else return ${water_depth_input};
};

6451
function system_sizing_inputs()
{
	show_desired_size = 0;
	show_sizing_warning = 0;
	show_layout_instructions = 0;
	if (value('array_sizing_mode') == 1)
	{
		show_desired_size = 1;
		if (value('system_capacity') != value('desired_array_size'))
			show_sizing_warning = 1;
	}
	if (value('array_sizing_mode') == 2)
		show_layout_instructions = 1;
	
	show('sizing_warning', show_sizing_warning);
	show('desired_array_size', show_desired_size);
	show('layout_instructions', show_layout_instructions);
	refresh();		
}

on_change{'cable_length_option'} = define() 
{
	check = value('cable_length_option');
	show('inter_array_cable_length', check == 0);
	show('export_cable_length', check == 0);
	show('riser_cable_length', check == 0);
	show('user_inter_array_cable_length', check == 1);
	show('user_export_cable_length', check == 1);
	show('user_riser_cable_length', check == 1);
	refresh();
};

function array_layout_inputs()
{
	if (value('array_sizing_mode') == 0) //single device
	{	
		show('number_rows', 1);
		show('devices_per_row', 1);
		show('user_input_number_rows', 0);
		show('user_input_devices_per_row', 0);
		show('device_spacing_in_row', 0);
		show('row_spacing', 0);
	}
	else if (value('array_sizing_mode') == 1) //auto layout
	{
		show('number_rows', 1);
		show('devices_per_row', 1);
		show('user_input_number_rows', 0);
		show('user_input_devices_per_row', 0);
		show('device_spacing_in_row', 1);
		show('row_spacing', 1);
	}
	else if (value('array_sizing_mode') == 2) //manual layout
	{
		show('number_rows', 0);
		show('devices_per_row', 0);
		show('user_input_number_rows', 1);
		show('user_input_devices_per_row', 1);
		show('device_spacing_in_row', 1);
		show('row_spacing', 1);
	}
	refresh();
}

function plot_mhk_array()
{
	setplot("mhk_array_plot");
	clearplot('mhk_array_plot');
	plotopt( {"title"="Array Layout","backcolor"=[255,255,255], "popup"=true, "legend"=false}  );
	
	xCoordinates = alloc(${number_devices});
	yCoordinates = alloc(${number_devices});
	
	for (i=0; i<${number_devices}; i++)
	{
		xCoordinates[i] = mod( i, ${devices_per_row} ) * ${device_spacing_in_row};
		yCoordinates[i] = floor( i / ${devices_per_row} ) * ${row_spacing};
	}

	plot( xCoordinates, yCoordinates,  {"thick"=2, "type"="scatter", "scale"=true});

	width = property( 'mhk_array_plot', 'width' );
	height = property( 'mhk_array_plot', 'height' );
	
	xmax = max( xCoordinates );
	xmin = min( xCoordinates );
	ymax = max( yCoordinates );
	ymin = min( yCoordinates );

	ratio = width/height;
	xspan = xmax - xmin;
	yspan = ymax - ymin;

	padx = max(xspan * 0.05, 3);
	pady = max(yspan * 0.05, 3);	
	
	axis( 'x1', {'label'='meters', 'min'=floor(xmin-padx), 'max'=ceil(xmin+xspan+padx) });
	axis( 'y1', {'label'='meters', 'min'=floor(ymin-pady), 'max'=ceil(ymin+yspan+pady) });
	
	return 0;
}

on_load{'Marine Array'} = define()
{
	system_sizing_inputs();
	array_layout_inputs();
	plot_mhk_array();
	wavefile_spacing_check();
	on_change{'cable_length_option'}();
	show('riser_cable_length', value('floating_array'));
	show('user_riser_cable_length', value('floating_array'));
	refresh();
};

on_change{'array_sizing_mode'} = define()
{
	system_sizing_inputs();
	array_layout_inputs();
};

on_change{'number_rows'} = define()
{
	plot_mhk_array();
};

on_change{'devices_per_row'} = define()
{
	plot_mhk_array();
};

on_change{'row_spacing'} = define()
{
	plot_mhk_array();
};

on_change{'device_spacing_in_row'} = define()
{
	plot_mhk_array();
};

on_change{'floating_array'} = define()
{
	show('riser_cable_length', value('floating_array'));
	refresh();
};

on_change{'use_wavefile_spacing'} = define() {
	wavefile_spacing_check();
};

function wavefile_spacing_check()
{
	model_choice = 1;
	if (technology() == "MEtidal") model_choice = 0;
	else if (financing() != "Single Owner") {
		if (value('wave_resource_model_choice') == 0) {
			model_choice = 0;
		}
	}
	if ((technology() == "MEwave" || technology() == "MEwave Battery") 
		&& model_choice == 1) {
		spacing = (value('use_wavefile_spacing')==1);
		show('distance_to_shore_input',!spacing);
		show('water_depth_input',!spacing);
		show('distance_to_shore_file', spacing);
		show('water_depth_file', spacing);
		show('use_wavefile_spacing_label', true);
		show('use_wavefile_spacing',true);
		/*
		distance = value('distance_to_shore');
		depth = value('water_depth');
		if (spacing == 1) {
			value('distance_to_shore',value('distance_to_shore_file'));
			value('water_depth',value('water_depth_file'));
		}
		else {
			value('distance_to_shore', distance);
			value('water_depth', depth);
		}
		*/
		refresh();
	}
	else {
		show('use_wavefile_spacing', false);
		show('use_wavefile_spacing_label', false);
		show('distance_to_shore_file', false);
		show('water_depth_file', false);
		refresh();
	}
	
}

on_change{'use_onshore_substation'} = define() {
	onshore_substation_check();
};

function onshore_substation_check() {
	check = value('use_onshore_substation');
	if (check == 0) {
		property('use_onshore_substation', 'Text', 'No');
	}
	else {
		property('use_onshore_substation', 'Text', 'Yes');
	}
	enable('load_grid_voltage', check == 1);
	enable('load_grid_voltage_options', check == 1);
}

function offshore_substation_check() {
	check = value('offshore_substation_choice');
	if (check == 0) {
		if (value('export_cable_voltage') == value('inter_array_cable_voltage')) {
			property('use_onshore_substation', 'Text', 'Yes');
		}
		else {
			property('use_onshore_substation', 'Text', 'No');
		}
	}
	else if (check == 1) {
		property('use_onshore_substation', 'Text', 'Yes');
	}
	else {
		property('use_onshore_substation', 'Text', 'No');
	}
}

on_change{'offshore_substation_choice'} = define() {
	offshore_substation_check();
};

function export_cable_voltage_check() 
{
	check = value('export_cable_voltage_choice');
	if (check == 0) {
		show('export_cable_voltage_option_ac', false);
		show('export_cable_voltage_option_hvdc', false);
		if (value('export_cable_type') == 0) {
			property('export_cable_voltage_lbl', 'Caption', 'AC');
		}
		else {
			property('export_cable_voltage_lbl', 'Caption', 'HVDC');
		}
		
	}
	else if (check == 1) {
		show('export_cable_voltage_option_ac', true);
		show('export_cable_voltage_option_hvdc', false);
		property('export_cable_voltage_lbl', 'Caption', 'AC');
	}
	else {
		show('export_cable_voltage_option_ac', false);
		show('export_cable_voltage_option_hvdc', true);
		property('export_cable_voltage_lbl', 'Caption', 'HVDC');
		
	}
}
	
