{
    "Name": "Inverter Temp Derate PLC",
    "Width": 779.0,
    "Height": 316.0,
    "FormObjects": {
        "GroupBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "GroupBox1"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 12.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 6.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 764.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 306.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Inverter Temperature Derate Curves"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Button": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "btn_update_plc_plot"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 27.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 276.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 135.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Update plot"
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "inv_derate_label"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 171.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 267.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 324.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 42.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Table supports up to four temperature - slope pairs per row."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "DataMatrix": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "inv_tdc_plc"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 39.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 476.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 223.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "PasteAppendRows": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "PasteAppendCols": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ShowButtons": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ShowRows": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ShowRowLabels": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "RowLabels": {
                    "Type": 5.0,
                    "String": ""
                },
                "ShadeR0C0": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "VerticalLabel": {
                    "Type": 5.0,
                    "String": ""
                },
                "HorizontalLabel": {
                    "Type": 5.0,
                    "String": ""
                },
                "ShadeC0": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ShowCols": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ShowColLabels": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ColLabels": {
                    "Type": 5.0,
                    "String": "Vdc(V),Tstart(C),Slope(1/C),Tstart(C),Slope(1/C),Tstart(C),Slope(1/C),Tstart(C),Slope(1/C)"
                },
                "NumRowsLabel": {
                    "Type": 5.0,
                    "String": "Rows:"
                },
                "NumColsLabel": {
                    "Type": 5.0,
                    "String": "Cols:"
                },
                "Layout": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "ChoiceColumn": {
                    "Type": 3.0,
                    "Integer": -1.0
                },
                "Choices": {
                    "Type": 5.0,
                    "String": "Choice1,Choice2"
                },
                "HideColumn": {
                    "Type": 3.0,
                    "Integer": -1.0
                },
                "ShowColumn": {
                    "Type": 3.0,
                    "Integer": -1.0
                },
                "ColorMap": {
                    "Type": 2.0,
                    "Boolean": 0.0
                }
            }
        },
        "Plot": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "inv_tdc_plc_plot"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 501.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 27.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 270.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 262.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                }
            }
        }
    },
    "VarDatabase": {
        "inv_tdc_plc": {
            "Version": 4.0,
            "Type": 3.0,
            "Label": "Inv Temp Derate Part Load Curve",
            "Units": " ",
            "Group": "Inverter Temperature",
            "IndexLabels": "",
            "Flags": 3.0,
            "DefaultValue": [
                [
                    1.0,
                    52.8,
                    -0.021
                ]
            ],
            "UIObject": "DataMatrix",
            "sscVariableName": "",
            "sscVariableValue": ""
        }
    },
    "Equations": {},
    "Callbacks": {
        "1": "function inv_tdc_plc_update_plot()",
        "2": "{",
        "3": "\tVdc = [];",
        "4": "\tT = [[]];",
        "5": "\tslope = [[]];",
        "6": "\t",
        "7": "\tinput = ${inv_tdc_plc};",
        "8": "\tnr = #input;",
        "9": "\tidx=0;",
        "10": "\twhile( idx < nr )",
        "11": "\t{",
        "12": "\t\tif (input[idx][0] > 0){",
        "13": "\t\t\tVdc[idx] = input[idx][0];",
        "14": "\t\t\tif (mod(#input[idx]-1, 2) != 0 || #input[idx] > 9) {",
        "15": "\t\t\t\tmsgbox('Inverter Temperature Derate Table Error.\\nThe number of columns in the table is incorrect. Each row must have one Vdc value and at least one pair of Tstart-Slope values. Acceptable numbers of columns are 3, 5, 7, and 9 for up to four Tstart-Slope pairs.');",
        "16": "\t\t\t\tproperty('inv_derate_label', 'Caption', 'Inputs are incorrect. Please check the number of columns in the table.');",
        "17": "\t\t\t\tproperty('inv_derate_label', 'TextColour', 'red');",
        "18": "\t\t\t\treturn;",
        "19": "\t\t\t}",
        "20": "\t\t\telse {",
        "21": "\t\t\t\tproperty('inv_derate_label', 'Caption', 'Table supports up to four temperature - slope pairs per row.');",
        "22": "\t\t\t\tproperty('inv_derate_label', 'TextColour', 'black');",
        "23": "\t\t\t}",
        "24": "\t\t\tfor ( p = 0; p<(#input[idx]-1)/2; p++ ){",
        "25": "\t\t\t\tT[idx][p] = input[idx][2*p+1];",
        "26": "\t\t\t\tif (T[idx][p] < -273) {",
        "27": "\t\t\t\t\tmsgbox('Inverter Temperature Derate Table Error.\\nStart temp '+p+ ' of curve ' + idx+ ' is not valid.');",
        "28": "\t\t\t\t\tproperty('inv_derate_label', 'Caption', 'Inputs are not correct. Start temp '+p+ ' of curve ' + idx+ ' is not valid');",
        "29": "\t\t\t\t\tproperty('inv_derate_label', 'TextColour', 'red');",
        "30": "\t\t\t\t\tT[idx][p] = 0;",
        "31": "\t\t\t\t}",
        "32": "\t\t\t\t",
        "33": "\t\t\t\tslope[idx][p] = input[idx][2*p+2];",
        "34": "\t\t\t\tif (slope[idx][p] > 0 || slope[idx][p] < -1) {",
        "35": "\t\t\t\t\tmsgbox('Inverter Temperature Derate Table Error.\\nSlope '+p+ ' of curve ' + idx+ ' is not valid.');",
        "36": "\t\t\t\t\tproperty('inv_derate_label', 'Caption', 'Inputs are not correct. Slope '+p+ ' of curve ' + idx+ ' is not valid.');",
        "37": "\t\t\t\t\tproperty('inv_derate_label', 'TextColour', 'red');",
        "38": "\t\t\t\t\tslope[idx][p] = 0;\t",
        "39": "\t\t\t\t}",
        "40": "\t\t\t}",
        "41": "\t\t}",
        "42": "\t\tidx++;",
        "43": "\t}",
        "44": "\t",
        "45": "\tcurves = [ [ 1000, 25, 'black' ],",
        "46": "\t\t\t   [ 800,  25, 'blue' ],",
        "47": "\t\t\t   [ 600,  25, 'red' ],",
        "48": "\t\t\t   [ 400,  25, 'forest green' ],",
        "49": "\t\t\t   [ 200,  25, 'orange' ] ];",
        "50": "\t\t\t   ",
        "51": "\tsetplot( 'inv_tdc_plc_plot' );",
        "52": "\tclearplot();",
        "53": "\t",
        "54": "\tconst np = 150;",
        "55": "\txx = alloc(np);",
        "56": "\tyy = alloc(np);",
        "57": "\tfor( i=0;i<#Vdc;i++ )",
        "58": "\t{\t",
        "59": "\t\tnPairs = #T[i];",
        "60": "\t",
        "61": "\t\txx[0] = 0;",
        "62": "\t\tyy[0] = (0 <= T[i][0] ) ? 1 : 1+slope[i][0]*(-T[i][0]);",
        "63": "\t\tpIdx = 1;",
        "64": "\t\twhile (pIdx*0.4 < T[i][0]){",
        "65": "\t\t\txx[pIdx] = pIdx*0.4;",
        "66": "\t\t\tyy[pIdx] = 1;",
        "67": "\t\t\tpIdx++;",
        "68": "\t\t}",
        "69": "\t\tfor (j=0; j<nPairs; j++){",
        "70": "\t\t\tintervalEnd = (j > #T[i] - 2) ? 60:  T[i][j+1];",
        "71": "\t\t\twhile( pIdx*0.4 < intervalEnd){",
        "72": "\t\t\t\txx[pIdx] = pIdx*0.4;",
        "73": "\t\t\t\tyy[pIdx] = yy[pIdx-1] + slope[i][j]*0.4;",
        "74": "\t\t\t\tif (yy[pIdx] <= 0) yy[pIdx] = 0;",
        "75": "\t\t\t\tpIdx++;",
        "76": "\t\t\t}",
        "77": "",
        "78": "\t\t}",
        "79": "\t\tplot(xx,yy,{'series'=sprintf('@ %g Vdc', Vdc[i]),",
        "80": "\t\t\t\"thick\"=1, \"scale\"=true,\"color\"=curves[i][2]});",
        "81": "",
        "82": "\t}",
        "83": "\t//Make the plot",
        "84": "\tplotopt({\"popup\"=false,\"backcolor\"=[255,255,255],\"legend\"=true, 'legendpos'='southwest'});",
        "85": "\taxis('x1', {'label'='Ambient Temp (C)', 'min'=0, 'max'=60});",
        "86": "\taxis('y1', {'label'='Max Power / Rated Power', 'min'=0, 'max'= (1.1)});",
        "87": "",
        "88": "}",
        "89": "",
        "90": "on_load{ 'Inverter Temp Derate PLC' } = define() {\t",
        "91": "\tinv_tdc_plc_update_plot();",
        "92": "};",
        "93": "",
        "94": "on_change{'btn_update_plc_plot'} = define() {\t",
        "95": "\tinv_tdc_plc_update_plot();",
        "96": "};"
    }
}