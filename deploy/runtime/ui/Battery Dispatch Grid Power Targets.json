{
    "Name": "Battery Dispatch Grid Power Targets",
    "Width": 1051.0,
    "Height": 146.0,
    "FormObjects": {
        "Choice": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "batt_target_choice"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 78.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 354.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Items": {
                    "Type": 6.0,
                    "StringList": "Monthly power targets|Time series power targets"
                },
                "Selection": {
                    "Type": 3.0,
                    "Integer": -1.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 2.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "batt_target_label"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 1026.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 51.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Battery charges when the electric load is less than the target in a given time step and discharges when the load is greater than the target. Enter either time series (hourly or subhourly) or monthly targets. Grid targets are maximum power values, so the battery may charge or discharge up to the target. The grid target power is the maximum desired power drawn from the grid over each timestep after contributions from PV and battery."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "DataArray": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "batt_target_power"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 606.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 108.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 117.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Label": {
                    "Type": 5.0,
                    "String": "Grid Power (kWac)"
                },
                "Description": {
                    "Type": 5.0,
                    "String": "Max desired power from grid after PV and battery."
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 4.0
                }
            }
        },
        "MonthlyFactor": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "batt_target_power_monthly"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 606.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 78.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 117.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Description": {
                    "Type": 5.0,
                    "String": "Monthly grid power targets in kWac."
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 3.0
                }
            }
        },
        "GroupBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "object 4"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 6.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 1042.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 136.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Input Grid Power Targets"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        }
    },
    "VarDatabase": {
        "batt_target_choice": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Grid power target options",
            "Units": " ",
            "Group": "Battery Dispatch",
            "IndexLabels": "",
            "Flags": 3.0,
            "DefaultValue": 0.0,
            "UIObject": "ListBox",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "batt_target_power": {
            "Version": 4.0,
            "Type": 2.0,
            "Label": "Time series grid power targets",
            "Units": "kWac",
            "Group": "Battery Dispatch",
            "IndexLabels": "",
            "Flags": 2.0,
            "DefaultValue": [
                0.0
            ],
            "UIObject": "DataArray",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "batt_target_power_monthly": {
            "Version": 4.0,
            "Type": 2.0,
            "Label": "Monthly grid power targets",
            "Units": "kWac",
            "Group": "Battery Dispatch",
            "IndexLabels": "",
            "Flags": 2.0,
            "DefaultValue": [
                0.0
            ],
            "UIObject": "MonthlyFactor",
            "sscVariableName": "",
            "sscVariableValue": ""
        }
    },
    "Equations": {},
    "Callbacks": {
        "1": "on_load{'Battery Dispatch Grid Power Targets'}=define()",
        "2": "{\t",
        "3": "\tvalue('batt_dispatch_choice', 1);",
        "4": "\ttoggle_dispatch_target();\t",
        "5": "};",
        "6": "",
        "7": "on_change{'batt_target_choice'} = define()",
        "8": "{",
        "9": "\ttoggle_dispatch_target();",
        "10": "};",
        "11": "",
        "12": "function toggle_dispatch_target()",
        "13": "{",
        "14": "\tmode = ${batt_dispatch_choice};",
        "15": "\tif (mode != 1)",
        "16": "\t\tenable_target_inputs(false);",
        "17": "\telse",
        "18": "\t\tenable_target_inputs(true);",
        "19": "}",
        "20": "",
        "21": "function enable_target_inputs(on_off)",
        "22": "{",
        "23": "\tif (!on_off)",
        "24": "\t{",
        "25": "\t\tenable('batt_target_choice',on_off);",
        "26": "\t\tenable('batt_target_power',on_off);",
        "27": "\t\tenable('batt_target_power_monthly',on_off);",
        "28": "\t}",
        "29": "\telse ",
        "30": "\t{",
        "31": "\t\tenable('batt_target_choice',true);",
        "32": "\t\tmode = ${batt_target_choice};",
        "33": "\t\tif (mode == 0)",
        "34": "\t\t{",
        "35": "\t\t\tenable('batt_target_power',false);",
        "36": "\t\t\tenable('batt_target_power_monthly',true);",
        "37": "\t\t}",
        "38": "\t\telse",
        "39": "\t\t{",
        "40": "\t\t\tenable('batt_target_power',true);",
        "41": "\t\t\tenable('batt_target_power_monthly',false);",
        "42": "\t\t}",
        "43": "\t}",
        "44": "}",
        "45": ""
    }
}