{
    "Name": "Financial Analysis Parameters",
    "Width": 864.0,
    "Height": 111.0,
    "FormObjects": {
        "GroupBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "GroupBox1"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 6.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 850.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 101.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Analysis Parameters"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "analysis_period"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 252.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 60.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 1.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "analysis_period_warning"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 12.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 45.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 453.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 48.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": ""
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "inflation_rate"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 612.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 60.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 2.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 2.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "nominal_discount_rate"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 612.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 72.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 60.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 2.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 3.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "real_discount_rate"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 612.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 45.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 60.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 2.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 3.0
                }
            }
        }
    },
    "VarDatabase": {
        "analysis_period": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Analysis period",
            "Units": "years",
            "Group": "Financial Analysis Parameters",
            "IndexLabels": "",
            "Flags": 2.0,
            "DefaultValue": 30.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "analysis_period_warning": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Analysis Period Warning",
            "Units": " ",
            "Group": "Financial Analysis Parameters",
            "IndexLabels": "",
            "Flags": 5.0,
            "DefaultValue": "",
            "UIObject": "MultilineText",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "inflation_rate": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Inflation rate",
            "Units": "%/year",
            "Group": "Financial Analysis Parameters",
            "IndexLabels": "",
            "Flags": 2.0,
            "DefaultValue": 2.5,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "nominal_discount_rate": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Nominal discount rate",
            "Units": "%/year",
            "Group": "Financial Analysis Parameters",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "real_discount_rate": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Real discount rate",
            "Units": "%/year",
            "Group": "Financial Analysis Parameters",
            "IndexLabels": "",
            "Flags": 2.0,
            "DefaultValue": 5.5,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        }
    },
    "Equations": "equations{ '$MIMO$ fap_analysis_period' } = define() {\n\tif (financing() == 'Merchant Plant') {\n//\tmsgbox('FAP eqns financing, old ' + financing() + ', ' + analysis_period_old());\n\t\tif ((analysis_period_old()>= 1) && (${analysis_period} != analysis_period_old())) {\n//\t\t\tmsgbox('FAP updating new,old ' + ${analysis_period} + ', ' + analysis_period_old());\n\t\t\tdata.analysis_period =  ${analysis_period};\n\t\t\tdata.analysis_period_old =  analysis_period_old();\n\t\t\tdata.mp_energy_market_revenue =  ${mp_energy_market_revenue};\n\t\t\tdata.mp_ancserv1_revenue =  ${mp_ancserv1_revenue};\n\t\t\tdata.mp_ancserv2_revenue =  ${mp_ancserv2_revenue};\n\t\t\tdata.mp_ancserv3_revenue =  ${mp_ancserv3_revenue};\n\t\t\tdata.mp_ancserv4_revenue =  ${mp_ancserv4_revenue};\n\t\t\tdata.mp_energy_market_revenue_single =  ${mp_energy_market_revenue_single};\n\t\t\tdata.mp_ancserv1_revenue_single =  ${mp_ancserv1_revenue_single};\n\t\t\tdata.mp_ancserv2_revenue_single =  ${mp_ancserv2_revenue_single};\n\t\t\tdata.mp_ancserv3_revenue_single =  ${mp_ancserv3_revenue_single};\n\t\t\tdata.mp_ancserv4_revenue_single =  ${mp_ancserv4_revenue_single};\n\n\t\t\tsuccess = ssc_eqn('analysisperiodchange', data);\n\t\t\t\n\t\t\tif (!success){\n\t\t\t\tmsgbox('success ' + success);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// need intermediate variable to update\n\t\t\t\t${mp_energy_market_revenue_ui} = data.mp_energy_market_revenue;\n\t\t\t\t${mp_ancserv1_revenue_ui} = data.mp_ancserv1_revenue;\n\t\t\t\t${mp_ancserv2_revenue_ui} = data.mp_ancserv2_revenue;\n\t\t\t\t${mp_ancserv3_revenue_ui} = data.mp_ancserv3_revenue;\n\t\t\t\t${mp_ancserv4_revenue_ui} = data.mp_ancserv4_revenue;\n\t\t\t\t${mp_energy_market_revenue_single_ui} = data.mp_energy_market_revenue_single;\n\t\t\t\t${mp_ancserv1_revenue_single_ui} = data.mp_ancserv1_revenue_single;\n\t\t\t\t${mp_ancserv2_revenue_single_ui} = data.mp_ancserv2_revenue_single;\n\t\t\t\t${mp_ancserv3_revenue_single_ui} = data.mp_ancserv3_revenue_single;\n\t\t\t\t${mp_ancserv4_revenue_single_ui} = data.mp_ancserv4_revenue_single;\n\t\t\t}\n\t\t\t\n\t\t\tif (data.analysisperiodchange_check == 0)\n\t\t\t{\n\t\t\t\tmsg = data.analysisperiodchange_error;\n\t\t\t\tmsgbox(msg);\n\t\t\t}\n\t\t}\n\t\t\n\t}\n\treturn 0;\n};\n\nequations{ 'nominal_discount_rate' } = define() {\n\treturn ( (1.0 + ${real_discount_rate}/100.0) * (1.0 + ${inflation_rate}/100.0) - 1.0 ) * 100.0; \n};\n\n",
    "Callbacks": "on_load{'Financial Analysis Parameters'} = define() {\n\ttxt = analysis_period_message();\n\tproperty('analysis_period_warning','caption',txt);\n};\n\nfunction analysis_period_message() {\n  fin = financing();\n  debt = true;\n  msg = '';\n  if ( fin == 'All Equity Partnership Flip' || fin == 'Single Owner' || fin == 'Sale Leaseback' || fin == 'Leveraged Parntership Flip' ) {\n\tif ( value('analysis_period') < value('flip_target_year') )\n\t\tmsg = 'Analysis period is less than IRR target year. ';\n  }\n  if ( fin == 'All Equity Partnership Flip' || fin == 'Sale Leaseback' ) {\n    debt = false;\n    if ( fin == 'All Equity Partnership Flip' ) {\n\t\tif ( value('analysis_period') < value('sponsor_cap_recovery_year') )\n\t\t\tmsg = msg + 'Analysis period is less than capital recovery period. ';\n\t}\t\n  }\n  if ( debt == true ) {\n    if ( fin == 'Residential' || fin == 'Commercial' ) {\n      if ( value('loan_term') > value('analysis_period') && value('debt_fraction') > 0 )\n        msg = 'Analysis period is shorter than the debt payment period (loan term). The cash flow will not account for debt liability beyond the analysis period. ';\n    }  \n    else {\n      ppa_debt = (value('debt_option') == 1 && value('dscr') > 0) || (value('debt_option')==0 && value('debt_percent')) > 0;\n      if ( value('term_tenor') > value('analysis_period') && ppa_debt==true )\n        msg = 'Analysis period is shorter than the debt payment period (tenor). The cash flow will not account for debt liability beyond the analysis period. ';\n      if (fin != 'Merchant Plant' && fin != 'Community Solar')  \n      {\n\t\tif ( value('flip_target_year') > value('analysis_period') && ppa_debt==true )\n\t\t\tmsg = msg + 'IRR target year is greater than the analysis period. Choose a target year less than the analysis period. ';\n      }\n    }        \n  }\n  return msg;\n}\n\non_change{'analysis_period'} = define() {\n  if  ( financing() == 'Merchant Plant') {\n\tmsgbox('Analysis period changed!\\nThe merchant plant price data may not match the analysis period. Go to the Revenue page to update the Energy Market or Ancillary Service price data as appropriate.');\n\tvalue('mp_energy_market_revenue', value('mp_energy_market_revenue_ui'));\n\tvalue('mp_ancserv1_revenue', value('mp_ancserv1_revenue_ui'));\n\tvalue('mp_ancserv2_revenue', value('mp_ancserv2_revenue_ui'));\n\tvalue('mp_ancserv3_revenue', value('mp_ancserv3_revenue_ui'));\n\tvalue('mp_ancserv4_revenue', value('mp_ancserv4_revenue_ui'));\n\tvalue('mp_energy_market_revenue_single', value('mp_energy_market_revenue_single_ui'));\n\tvalue('mp_ancserv1_revenue_single', value('mp_ancserv1_revenue_single_ui'));\n\tvalue('mp_ancserv2_revenue_single', value('mp_ancserv2_revenue_single_ui'));\n\tvalue('mp_ancserv3_revenue_single', value('mp_ancserv3_revenue_single_ui'));\n\tvalue('mp_ancserv4_revenue_single', value('mp_ancserv4_revenue_single_ui'));\n  }\n  if (( technology() == 'Flat Plate PV') ||  ( technology() == 'PV Battery')){\n  \tvalue('ac_lifetime_losses', value('ac_lifetime_losses_ui'));\n  \tvalue('dc_lifetime_losses', value('dc_lifetime_losses_ui'));\n  }\n  txt = analysis_period_message();\n  property('analysis_period_warning','caption',txt);\n};\n"
}