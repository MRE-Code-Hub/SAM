{
    "Name": "Battery Dispatch Standalone Options FOM",
    "Width": 1053.0,
    "Height": 158.0,
    "FormObjects": {
        "CheckBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "batt_dispatch_auto_can_gridcharge"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 306.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 60.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 348.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Battery can charge from grid"
                },
                "State": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 6.0
                }
            }
        },
        "RadioChoice": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "batt_dispatch_choice_ui"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 15.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 57.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 288.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 88.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Selection": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Items": {
                    "Type": 6.0,
                    "StringList": "Automated dispatch|Dispatch to custom time series|Manual dispatch"
                },
                "ShowCaptions": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Horizontal": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 1.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "lbl_dispatch_options"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 15.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 918.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 36.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": ""
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "lbl_fom_warning_message"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 657.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 60.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 381.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 83.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": ""
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "GroupBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "object 4"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 6.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 1042.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 150.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Front-of-meter (FOM) Storage Dispatch Options"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        }
    },
    "VarDatabase": {
        "batt_dispatch_auto_can_gridcharge": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Battery can charge from grid",
            "Units": "0/1",
            "Group": "Battery Dispatch",
            "IndexLabels": "",
            "Flags": 3.0,
            "DefaultValue": 0.0,
            "UIObject": "CheckBox",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "batt_dispatch_choice": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Battery dispatch option",
            "Units": " ",
            "Group": "Battery Dispatch",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "batt_dispatch_choice_ui": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Battery dispatch options FOM",
            "Units": " ",
            "Group": "Battery Dispatch",
            "IndexLabels": "",
            "Flags": 3.0,
            "DefaultValue": 0.0,
            "UIObject": "RadioChoice",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "degradation": {
            "Version": 4.0,
            "Type": 2.0,
            "Label": " ",
            "Units": " ",
            "Group": "Battery Dispatch",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": [
                0.0
            ],
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "en_batt": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Enable battery model",
            "Units": " ",
            "Group": "Battery Dispatch",
            "IndexLabels": "",
            "Flags": 9.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "system_use_lifetime_output": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": " ",
            "Units": " ",
            "Group": "Battery Dispatch",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        }
    },
    "Equations": {
        "1": "equations{'batt_dispatch_choice'} = define() {",
        "2": "\tif (${batt_dispatch_choice_ui} == 0)",
        "3": "\t\treturn ${batt_dispatch_choice_ui};",
        "4": "\telse",
        "5": "\t\treturn ${batt_dispatch_choice_ui} + 1;",
        "6": "};",
        "7": "",
        "8": "equations{'system_use_lifetime_output'} = define() {",
        "9": "\treturn 1;",
        "10": "};",
        "11": "",
        "12": "equations {'degradation'} = define() {",
        "13": "\treturn [0];",
        "14": "};",
        "15": "",
        "16": "equations {'en_batt'} = define() {",
        "17": "\treturn 1;",
        "18": "};"
    },
    "Callbacks": {
        "1": "on_load{'Battery Dispatch Standalone Options FOM'} = define() ",
        "2": "{",
        "3": "\tshow_hide_charge_options();",
        "4": "\tcheck_auto_ppa();",
        "5": "\twarning_message();",
        "6": "\tif ( technology() == 'Fuel Cell' && value('en_batt') == 0 )",
        "7": "\t{ ",
        "8": "\t\tmsg = 'Battery storage is not enabled. Enable battery on Battery Storage page before setting storage dispatch options.';",
        "9": "\t\tclr = 'red';",
        "10": "\t}",
        "11": "\telse",
        "12": "\t{",
        "13": "\t\tmsg = 'The storage dispatch options determine how and when the battery charges and discharges. Choose an option below and then provide the dispatch details as appropriate.';",
        "14": "\t\tclr = 'black';",
        "15": "\t}",
        "16": "\tproperty('lbl_dispatch_options','Caption',msg);",
        "17": "\tproperty('lbl_dispatch_options','TextColour',clr);",
        "18": "};",
        "19": "",
        "20": "on_change{'batt_dispatch_choice_ui'} = define() ",
        "21": "{",
        "22": "\tshow_hide_charge_options();",
        "23": "\tcheck_auto_ppa();",
        "24": "\tvalue('batt_dispatch_excl', value('batt_dispatch_choice_ui'));",
        "25": "};",
        "26": "",
        "27": "function check_auto_ppa()",
        "28": "{",
        "29": "\tdispatch = value('batt_dispatch_choice_ui');",
        "30": "\tif (dispatch == 0 && financing() != 'Merchant Plant') ",
        "31": "\t{",
        "32": "\t\tppa_mode = value('ppa_soln_mode');",
        "33": "\t\tif (ppa_mode == 0) ",
        "34": "\t\t{",
        "35": "\t\t\tmsgbox('Specify IRR Target not available for automated dispatch.\\nThe automated battery dispatch options require the Specify PPA Price option on the Revenue or Financial Parameters page.\\n\\nPlease change Specify IRR Target to Specify PPA Price and specify a PPA price and optional escalation rate to use the Automated Dispatch options.');",
        "36": "\t\t}",
        "37": "\t}",
        "38": "}",
        "39": "",
        "40": "// hide charge options for manual dispatch",
        "41": "function show_hide_charge_options()",
        "42": "{",
        "43": "\toption = value('batt_dispatch_choice_ui');",
        "44": "\tif (option == 2) ",
        "45": "\t{",
        "46": "\t\tvalue('batt_dispatch_auto_can_gridcharge', false);",
        "47": "\t\tshow('batt_dispatch_auto_can_gridcharge', false);",
        "48": "\t\trefresh();",
        "49": "\t}",
        "50": "\telse ",
        "51": "\t{",
        "52": "\t\tvalue('batt_dispatch_auto_can_gridcharge', true);",
        "53": "\t\tenable('batt_dispatch_auto_can_gridcharge', false);",
        "54": "\t}",
        "55": "}",
        "56": "",
        "57": "function warning_message() ",
        "58": "{",
        "59": "\tis_dc = (value('batt_ac_or_dc' ) == 0);",
        "60": "\tcolor = 'black';",
        "61": "\tif ( is_dc )",
        "62": "\t{",
        "63": "\t\tmsg = 'Battery is DC-connected.'; ",
        "64": "\t}",
        "65": "\telse",
        "66": "\t{ ",
        "67": "\t\tmsg = 'Battery is AC-connected.'; ",
        "68": "\t}",
        "69": "\tif ( value('batt_dispatch_choice_ui') == 2 ) ",
        "70": "\t{",
        "71": "\t\tmsg = ''; ",
        "72": "\t}",
        "73": "\t/*",
        "74": "\telseif ( value('batt_dispatch_choice_ui') == 3 ) ",
        "75": "\t{ ",
        "76": "\t\tif ( technology() != 'PV Battery' )",
        "77": "\t\t{",
        "78": "\t\t\tmsg = 'The PV smoothing option only works for PV Battery configurations.';",
        "79": "\t\t\tcolor = 'red'; ",
        "80": "\t\t}\t",
        "81": "\t}",
        "82": "\t*/",
        "83": "\tproperty('lbl_fom_warning_message','Caption',msg);",
        "84": "\tproperty('lbl_fom_warning_message','TextColour',color);",
        "85": "}",
        "86": ""
    }
}